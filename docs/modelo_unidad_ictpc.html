<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 7 06_Modelo_unidad_ictpc.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024</title>
  <meta name="description" content="Manual de procesamiento." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 7 06_Modelo_unidad_ictpc.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Manual de procesamiento." />
  <meta name="github-repo" content="psirusteam/coneval" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 7 06_Modelo_unidad_ictpc.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024" />
  
  <meta name="twitter:description" content="Manual de procesamiento." />
  

<meta name="author" content="Andrés Gutiérrez, Stalyn Guerrero" />


<meta name="date" content="2024-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="validacion_encuestas.html"/>
<link rel="next" href="modelo_unidad_py_ic_ali_nc.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Taller de instalación de capacidades en SAE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="respositodio-de-códigos.html"><a href="respositodio-de-códigos.html"><i class="fa fa-check"></i>Respositodio de códigos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="librerias-de-r-y-otros-insumos.html"><a href="librerias-de-r-y-otros-insumos.html"><i class="fa fa-check"></i>Librerias de <em>R</em> y otros insumos</a>
<ul>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html"><i class="fa fa-check"></i>Librerías Utilizadas</a>
<ul>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#manipulación-y-transformación-de-datos"><i class="fa fa-check"></i>Manipulación y Transformación de Datos</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#lectura-y-escritura-de-datos"><i class="fa fa-check"></i>Lectura y Escritura de Datos</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#análisis-de-datos-de-encuestas"><i class="fa fa-check"></i>Análisis de Datos de Encuestas</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#modelado-y-análisis-estadístico"><i class="fa fa-check"></i>Modelado y Análisis Estadístico</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#visualización-de-datos"><i class="fa fa-check"></i>Visualización de Datos</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#informes-y-reproducibilidad"><i class="fa fa-check"></i>Informes y Reproducibilidad</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#integración-con-otros-lenguajes"><i class="fa fa-check"></i>Integración con Otros Lenguajes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bases-de-datos-utilizadas.html"><a href="bases-de-datos-utilizadas.html"><i class="fa fa-check"></i>Bases de Datos Utilizadas</a></li>
<li class="chapter" data-level="" data-path="estructura-del-proyecto.html"><a href="estructura-del-proyecto.html"><i class="fa fa-check"></i>Estructura del Proyecto</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="union_bases.html"><a href="union_bases.html"><i class="fa fa-check"></i><b>1</b> 00_union_bases.R</a></li>
<li class="chapter" data-level="2" data-path="descarga_satelitales.html"><a href="descarga_satelitales.html"><i class="fa fa-check"></i><b>2</b> 01_Descarga_satelitales.R</a></li>
<li class="chapter" data-level="3" data-path="union_predictores.html"><a href="union_predictores.html"><i class="fa fa-check"></i><b>3</b> 02_Union_predictores.R</a></li>
<li class="chapter" data-level="4" data-path="estandarizar_muestra_cuestionario_ampliado.html"><a href="estandarizar_muestra_cuestionario_ampliado.html"><i class="fa fa-check"></i><b>4</b> 03_Estandarizar_muestra_cuestionario_ampliado.R</a></li>
<li class="chapter" data-level="5" data-path="armonizar_encuesta.html"><a href="armonizar_encuesta.html"><i class="fa fa-check"></i><b>5</b> 04_Armonizar_encuesta.R</a></li>
<li class="chapter" data-level="6" data-path="validacion_encuestas.html"><a href="validacion_encuestas.html"><i class="fa fa-check"></i><b>6</b> 05_Validacion_encuestas.R</a></li>
<li class="chapter" data-level="7" data-path="modelo_unidad_ictpc.html"><a href="modelo_unidad_ictpc.html"><i class="fa fa-check"></i><b>7</b> 06_Modelo_unidad_ictpc.R</a></li>
<li class="chapter" data-level="8" data-path="modelo_unidad_py_ic_ali_nc.html"><a href="modelo_unidad_py_ic_ali_nc.html"><i class="fa fa-check"></i><b>8</b> 07_Modelo_unidad_py_ic_ali_nc.R</a></li>
<li class="chapter" data-level="9" data-path="modelo_unidad_py_ic_segsoc.html"><a href="modelo_unidad_py_ic_segsoc.html"><i class="fa fa-check"></i><b>9</b> 08_Modelo_unidad_py_ic_segsoc</a></li>
<li class="chapter" data-level="10" data-path="postbenchmarking_ictpc.html"><a href="postbenchmarking_ictpc.html"><i class="fa fa-check"></i><b>10</b> 09_PostBenchmarking_ictpc.R</a></li>
<li class="chapter" data-level="11" data-path="postbenchmarking_ic_ali_nc.html"><a href="postbenchmarking_ic_ali_nc.html"><i class="fa fa-check"></i><b>11</b> 10_PostBenchmarking_ic_ali_nc.R</a></li>
<li class="chapter" data-level="12" data-path="postbenchmarking_ic_segsoc.html"><a href="postbenchmarking_ic_segsoc.html"><i class="fa fa-check"></i><b>12</b> 11_PostBenchmarking_ic_segsoc</a></li>
<li class="chapter" data-level="13" data-path="imputacion_censal.html"><a href="imputacion_censal.html"><i class="fa fa-check"></i><b>13</b> 12_Imputacion_censal</a></li>
<li class="chapter" data-level="14" data-path="estimacion_ent_02.html"><a href="estimacion_ent_02.html"><i class="fa fa-check"></i><b>14</b> 13_Estimacion_ent_02.R</a></li>
<li class="chapter" data-level="15" data-path="estimacion_municipios_ipm_pobreza.html"><a href="estimacion_municipios_ipm_pobreza.html"><i class="fa fa-check"></i><b>15</b> 14_estimacion_municipios_ipm_pobreza.R</a></li>
<li class="chapter" data-level="16" data-path="estimacion_municipios_ipm_pobreza_error.html"><a href="estimacion_municipios_ipm_pobreza_error.html"><i class="fa fa-check"></i><b>16</b> 15_estimacion_municipios_ipm_pobreza_error.R</a></li>
<li class="chapter" data-level="17" data-path="mapas.html"><a href="mapas.html"><i class="fa fa-check"></i><b>17</b> 16_Mapas.R</a></li>
<li class="chapter" data-level="18" data-path="estimacion_municipios_carencias.html"><a href="estimacion_municipios_carencias.html"><i class="fa fa-check"></i><b>18</b> 17_estimacion_municipios_carencias.R</a></li>
<li class="divider"></li>
<li><a Taller de instalación de capacidades en SAE </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelo_unidad_ictpc.r" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Capítulo 7</span> 06_Modelo_unidad_ictpc.R<a href="modelo_unidad_ictpc.html#modelo_unidad_ictpc.r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Para la ejecución del presente archivo, debe abrir el archivo <strong>06_Modelo_unidad_ictpc.R</strong> disponible en la ruta <em>Rcodes/2020/06_Modelo_unidad_ictpc.R</em>.</p>
<p>Este script en R se enfoca en la creación de un modelo multinivel utilizando datos de encuestas y censos para predecir ingresos. El proceso comienza con la limpieza del entorno de trabajo mediante <code>rm(list = ls())</code> y la carga de librerías esenciales para el análisis, tales como <code>patchwork</code>, <code>nortest</code>, <code>lme4</code>, <code>tidyverse</code>, <code>magrittr</code>, <code>caret</code>, <code>car</code>, y una fuente externa de modelos (<code>source("source/modelos_freq.R")</code>). Posteriormente, se definen las variables de agregación (<code>byAgrega</code>), se incrementa el límite de memoria disponible, y se cargan las bases de datos necesarias (<code>encuesta_sta</code>, <code>censo_sta</code>, <code>statelevel_predictors_df</code>). Se seleccionan las variables covariantes excluyendo aquellas que comienzan con <code>hog_</code> o <code>cve_mun</code>.</p>
<p>En la selección de variables relevantes, se mencionan algunos pasos comentados que realizan la selección de características utilizando el método <code>rfe</code> de <code>caret</code>. Las variables seleccionadas se listan explícitamente en <code>variables_seleccionadas</code> y se combinan con otras covariantes para formar <code>cov_names</code>. Luego, se construye la fórmula del modelo (<code>formula_model</code>), que incluye efectos aleatorios para <code>cve_mun</code>, <code>hlengua</code> y <code>discapacidad</code>, así como efectos fijos para las demás variables. Esto asegura que el modelo considere tanto la variabilidad dentro de cada grupo como las características específicas de cada variable.</p>
<p>Finalmente, se realiza una transformación la variable de ingreso (<code>ingreso</code>) a formato numérico y se ajusta el modelo utilizando la función <code>modelo_ingreso</code>, que está definida en el archivo fuente cargado previamente. Los datos de entrada incluyen <code>encuesta_sta</code>, <code>statelevel_predictors_df</code>, <code>censo_sta</code> y la fórmula del modelo. Los resultados del modelo se guardan en un archivo RDS (<code>fit_mrp_ictpc.rds</code>). Se generan y guardan gráficos de densidad y histogramas de las distribuciones posteriores utilizando <code>ggsave</code>, proporcionando una visualización clara de los resultados obtenidos.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="modelo_unidad_ictpc.html#cb7-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>())</span>
<span id="cb7-2"><a href="modelo_unidad_ictpc.html#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="modelo_unidad_ictpc.html#cb7-3" tabindex="-1"></a><span class="co"># Loading required libraries ----------------------------------------------</span></span>
<span id="cb7-4"><a href="modelo_unidad_ictpc.html#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="modelo_unidad_ictpc.html#cb7-5" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb7-6"><a href="modelo_unidad_ictpc.html#cb7-6" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb7-7"><a href="modelo_unidad_ictpc.html#cb7-7" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb7-8"><a href="modelo_unidad_ictpc.html#cb7-8" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-9"><a href="modelo_unidad_ictpc.html#cb7-9" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb7-10"><a href="modelo_unidad_ictpc.html#cb7-10" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb7-11"><a href="modelo_unidad_ictpc.html#cb7-11" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb7-12"><a href="modelo_unidad_ictpc.html#cb7-12" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;../source/modelos_freq.R&quot;</span>)</span>
<span id="cb7-13"><a href="modelo_unidad_ictpc.html#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="modelo_unidad_ictpc.html#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="modelo_unidad_ictpc.html#cb7-15" tabindex="-1"></a>byAgrega <span class="ot">&lt;-</span></span>
<span id="cb7-16"><a href="modelo_unidad_ictpc.html#cb7-16" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;ent&quot;</span>,</span>
<span id="cb7-17"><a href="modelo_unidad_ictpc.html#cb7-17" tabindex="-1"></a>    <span class="st">&quot;cve_mun&quot;</span>,</span>
<span id="cb7-18"><a href="modelo_unidad_ictpc.html#cb7-18" tabindex="-1"></a>    <span class="st">&quot;area&quot;</span>,</span>
<span id="cb7-19"><a href="modelo_unidad_ictpc.html#cb7-19" tabindex="-1"></a>    <span class="st">&quot;sexo&quot;</span>,</span>
<span id="cb7-20"><a href="modelo_unidad_ictpc.html#cb7-20" tabindex="-1"></a>    <span class="st">&quot;edad&quot;</span>,</span>
<span id="cb7-21"><a href="modelo_unidad_ictpc.html#cb7-21" tabindex="-1"></a>    <span class="st">&quot;discapacidad&quot;</span>,</span>
<span id="cb7-22"><a href="modelo_unidad_ictpc.html#cb7-22" tabindex="-1"></a>    <span class="st">&quot;hlengua&quot;</span>,</span>
<span id="cb7-23"><a href="modelo_unidad_ictpc.html#cb7-23" tabindex="-1"></a>    <span class="st">&quot;nivel_edu&quot;</span> )</span>
<span id="cb7-24"><a href="modelo_unidad_ictpc.html#cb7-24" tabindex="-1"></a></span>
<span id="cb7-25"><a href="modelo_unidad_ictpc.html#cb7-25" tabindex="-1"></a><span class="co"># Loading data ------------------------------------------------------------</span></span>
<span id="cb7-26"><a href="modelo_unidad_ictpc.html#cb7-26" tabindex="-1"></a><span class="fu">memory.limit</span>(<span class="dv">10000000</span>)</span>
<span id="cb7-27"><a href="modelo_unidad_ictpc.html#cb7-27" tabindex="-1"></a>encuesta_sta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;../input/2020/enigh/encuesta_sta.rds&quot;</span>)</span>
<span id="cb7-28"><a href="modelo_unidad_ictpc.html#cb7-28" tabindex="-1"></a>censo_sta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;../input/2020/muestra_ampliada/muestra_cuestionario_ampliado.rds&quot;</span>)</span>
<span id="cb7-29"><a href="modelo_unidad_ictpc.html#cb7-29" tabindex="-1"></a>statelevel_predictors_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;../input/2020/predictores/statelevel_predictors_df.rds&quot;</span>)</span>
<span id="cb7-30"><a href="modelo_unidad_ictpc.html#cb7-30" tabindex="-1"></a></span>
<span id="cb7-31"><a href="modelo_unidad_ictpc.html#cb7-31" tabindex="-1"></a>cov_names <span class="ot">&lt;-</span> <span class="fu">names</span>(statelevel_predictors_df)</span>
<span id="cb7-32"><a href="modelo_unidad_ictpc.html#cb7-32" tabindex="-1"></a>cov_names <span class="ot">&lt;-</span> cov_names[<span class="sc">!</span><span class="fu">grepl</span>(<span class="at">x =</span> cov_names,<span class="at">pattern =</span> <span class="st">&quot;^hog_|cve_mun&quot;</span>)]</span>
<span id="cb7-33"><a href="modelo_unidad_ictpc.html#cb7-33" tabindex="-1"></a></span>
<span id="cb7-34"><a href="modelo_unidad_ictpc.html#cb7-34" tabindex="-1"></a><span class="co"># Selección de variables</span></span>
<span id="cb7-35"><a href="modelo_unidad_ictpc.html#cb7-35" tabindex="-1"></a></span>
<span id="cb7-36"><a href="modelo_unidad_ictpc.html#cb7-36" tabindex="-1"></a><span class="co"># encuesta_sta2 &lt;- encuesta_sta %&gt;% group_by_at((byAgrega)) %&gt;%</span></span>
<span id="cb7-37"><a href="modelo_unidad_ictpc.html#cb7-37" tabindex="-1"></a><span class="co">#   summarise(ingreso = mean(ictpc), .groups = &quot;drop&quot;,</span></span>
<span id="cb7-38"><a href="modelo_unidad_ictpc.html#cb7-38" tabindex="-1"></a><span class="co">#             n = n()) %&gt;%</span></span>
<span id="cb7-39"><a href="modelo_unidad_ictpc.html#cb7-39" tabindex="-1"></a><span class="co">#   inner_join(statelevel_predictors_df)</span></span>
<span id="cb7-40"><a href="modelo_unidad_ictpc.html#cb7-40" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-41"><a href="modelo_unidad_ictpc.html#cb7-41" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-42"><a href="modelo_unidad_ictpc.html#cb7-42" tabindex="-1"></a><span class="co"># resultado_rfe &lt;-</span></span>
<span id="cb7-43"><a href="modelo_unidad_ictpc.html#cb7-43" tabindex="-1"></a><span class="co">#   rfe(</span></span>
<span id="cb7-44"><a href="modelo_unidad_ictpc.html#cb7-44" tabindex="-1"></a><span class="co">#     encuesta_sta2[, cov_names],</span></span>
<span id="cb7-45"><a href="modelo_unidad_ictpc.html#cb7-45" tabindex="-1"></a><span class="co">#     encuesta_sta2$ingreso,</span></span>
<span id="cb7-46"><a href="modelo_unidad_ictpc.html#cb7-46" tabindex="-1"></a><span class="co">#     sizes = c(1:10),</span></span>
<span id="cb7-47"><a href="modelo_unidad_ictpc.html#cb7-47" tabindex="-1"></a><span class="co">#     rfeControl = rfeControl(functions = lmFuncs, method = &quot;LOOCV&quot;)</span></span>
<span id="cb7-48"><a href="modelo_unidad_ictpc.html#cb7-48" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb7-49"><a href="modelo_unidad_ictpc.html#cb7-49" tabindex="-1"></a><span class="co"># saveRDS(resultado_rfe, &quot;01_2020/01_ingreso_medio/Data/modelo/resultado_rfe.rds&quot;)</span></span>
<span id="cb7-50"><a href="modelo_unidad_ictpc.html#cb7-50" tabindex="-1"></a><span class="co"># resultado_rfe &lt;- readRDS(&quot;01_2020/01_ingreso_medio/Data/modelo/resultado_rfe.rds&quot;)</span></span>
<span id="cb7-51"><a href="modelo_unidad_ictpc.html#cb7-51" tabindex="-1"></a></span>
<span id="cb7-52"><a href="modelo_unidad_ictpc.html#cb7-52" tabindex="-1"></a>variables_seleccionadas <span class="ot">&lt;-</span></span>
<span id="cb7-53"><a href="modelo_unidad_ictpc.html#cb7-53" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb7-54"><a href="modelo_unidad_ictpc.html#cb7-54" tabindex="-1"></a>    <span class="st">&quot;prom_esc_rel_urb&quot;</span>,</span>
<span id="cb7-55"><a href="modelo_unidad_ictpc.html#cb7-55" tabindex="-1"></a>    <span class="st">&quot;smg1&quot;</span>,</span>
<span id="cb7-56"><a href="modelo_unidad_ictpc.html#cb7-56" tabindex="-1"></a>    <span class="st">&quot;gini15m&quot;</span> ,</span>
<span id="cb7-57"><a href="modelo_unidad_ictpc.html#cb7-57" tabindex="-1"></a>    <span class="st">&quot;ictpc15&quot;</span> ,</span>
<span id="cb7-58"><a href="modelo_unidad_ictpc.html#cb7-58" tabindex="-1"></a>    <span class="st">&quot;altitud1000&quot;</span>,</span>
<span id="cb7-59"><a href="modelo_unidad_ictpc.html#cb7-59" tabindex="-1"></a>    <span class="st">&quot;prom_esc_rel_rur&quot;</span> ,</span>
<span id="cb7-60"><a href="modelo_unidad_ictpc.html#cb7-60" tabindex="-1"></a>    <span class="st">&quot;porc_patnoagrnocal_urb&quot;</span>,</span>
<span id="cb7-61"><a href="modelo_unidad_ictpc.html#cb7-61" tabindex="-1"></a>    <span class="st">&quot;acc_medio&quot;</span>  ,</span>
<span id="cb7-62"><a href="modelo_unidad_ictpc.html#cb7-62" tabindex="-1"></a>    <span class="st">&quot;derhab_pea_15_20&quot;</span> ,</span>
<span id="cb7-63"><a href="modelo_unidad_ictpc.html#cb7-63" tabindex="-1"></a>    <span class="st">&quot;porc_norep_ing_urb&quot;</span></span>
<span id="cb7-64"><a href="modelo_unidad_ictpc.html#cb7-64" tabindex="-1"></a>  )</span>
<span id="cb7-65"><a href="modelo_unidad_ictpc.html#cb7-65" tabindex="-1"></a>cov_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-66"><a href="modelo_unidad_ictpc.html#cb7-66" tabindex="-1"></a>  <span class="st">&quot;modifica_humana&quot;</span>,  <span class="st">&quot;acceso_hosp&quot;</span>,           </span>
<span id="cb7-67"><a href="modelo_unidad_ictpc.html#cb7-67" tabindex="-1"></a>  <span class="st">&quot;acceso_hosp_caminando&quot;</span>,  <span class="st">&quot;cubrimiento_cultivo&quot;</span>,   </span>
<span id="cb7-68"><a href="modelo_unidad_ictpc.html#cb7-68" tabindex="-1"></a>  <span class="st">&quot;cubrimiento_urbano&quot;</span>,     <span class="st">&quot;luces_nocturnas&quot;</span> ,</span>
<span id="cb7-69"><a href="modelo_unidad_ictpc.html#cb7-69" tabindex="-1"></a>  variables_seleccionadas</span>
<span id="cb7-70"><a href="modelo_unidad_ictpc.html#cb7-70" tabindex="-1"></a>)</span>
<span id="cb7-71"><a href="modelo_unidad_ictpc.html#cb7-71" tabindex="-1"></a></span>
<span id="cb7-72"><a href="modelo_unidad_ictpc.html#cb7-72" tabindex="-1"></a>cov_registros <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(</span>
<span id="cb7-73"><a href="modelo_unidad_ictpc.html#cb7-73" tabindex="-1"></a>  cov_names,</span>
<span id="cb7-74"><a href="modelo_unidad_ictpc.html#cb7-74" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb7-75"><a href="modelo_unidad_ictpc.html#cb7-75" tabindex="-1"></a>    <span class="st">&quot;elec_mun20&quot;</span>,</span>
<span id="cb7-76"><a href="modelo_unidad_ictpc.html#cb7-76" tabindex="-1"></a>    <span class="st">&quot;elec_mun19&quot;</span>,</span>
<span id="cb7-77"><a href="modelo_unidad_ictpc.html#cb7-77" tabindex="-1"></a>    <span class="st">&quot;transf_gobpc_15_20&quot;</span>,</span>
<span id="cb7-78"><a href="modelo_unidad_ictpc.html#cb7-78" tabindex="-1"></a>    <span class="st">&quot;derhab_pea_15_20&quot;</span>,</span>
<span id="cb7-79"><a href="modelo_unidad_ictpc.html#cb7-79" tabindex="-1"></a>    <span class="st">&quot;vabpc_15_19&quot;</span> ,</span>
<span id="cb7-80"><a href="modelo_unidad_ictpc.html#cb7-80" tabindex="-1"></a>    <span class="st">&quot;itlpis_15_20&quot;</span>  ,</span>
<span id="cb7-81"><a href="modelo_unidad_ictpc.html#cb7-81" tabindex="-1"></a>    <span class="st">&quot;remespc_15_20&quot;</span>,</span>
<span id="cb7-82"><a href="modelo_unidad_ictpc.html#cb7-82" tabindex="-1"></a>    <span class="st">&quot;desem_15_20&quot;</span>,</span>
<span id="cb7-83"><a href="modelo_unidad_ictpc.html#cb7-83" tabindex="-1"></a>    <span class="st">&quot;smg1&quot;</span>,</span>
<span id="cb7-84"><a href="modelo_unidad_ictpc.html#cb7-84" tabindex="-1"></a>    <span class="st">&quot;ql_porc_cpa_urb&quot;</span>,</span>
<span id="cb7-85"><a href="modelo_unidad_ictpc.html#cb7-85" tabindex="-1"></a>    <span class="st">&quot;ql_porc_cpa_rur&quot;</span></span>
<span id="cb7-86"><a href="modelo_unidad_ictpc.html#cb7-86" tabindex="-1"></a>  )</span>
<span id="cb7-87"><a href="modelo_unidad_ictpc.html#cb7-87" tabindex="-1"></a>)</span>
<span id="cb7-88"><a href="modelo_unidad_ictpc.html#cb7-88" tabindex="-1"></a></span>
<span id="cb7-89"><a href="modelo_unidad_ictpc.html#cb7-89" tabindex="-1"></a></span>
<span id="cb7-90"><a href="modelo_unidad_ictpc.html#cb7-90" tabindex="-1"></a></span>
<span id="cb7-91"><a href="modelo_unidad_ictpc.html#cb7-91" tabindex="-1"></a>cov_registros <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cov_registros, <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>)</span>
<span id="cb7-92"><a href="modelo_unidad_ictpc.html#cb7-92" tabindex="-1"></a></span>
<span id="cb7-93"><a href="modelo_unidad_ictpc.html#cb7-93" tabindex="-1"></a>formula_model <span class="ot">&lt;-</span> </span>
<span id="cb7-94"><a href="modelo_unidad_ictpc.html#cb7-94" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">&quot;ingreso ~ (1 | cve_mun) + (1 | hlengua) + (1 | discapacidad) + ent + nivel_edu +  edad + area + sexo +&quot;</span>, </span>
<span id="cb7-95"><a href="modelo_unidad_ictpc.html#cb7-95" tabindex="-1"></a>      <span class="st">&quot; + &quot;</span>, cov_registros)</span>
<span id="cb7-96"><a href="modelo_unidad_ictpc.html#cb7-96" tabindex="-1"></a></span>
<span id="cb7-97"><a href="modelo_unidad_ictpc.html#cb7-97" tabindex="-1"></a>encuesta_sta<span class="sc">$</span>ingreso <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(encuesta_sta<span class="sc">$</span>ictpc)</span>
<span id="cb7-98"><a href="modelo_unidad_ictpc.html#cb7-98" tabindex="-1"></a></span>
<span id="cb7-99"><a href="modelo_unidad_ictpc.html#cb7-99" tabindex="-1"></a></span>
<span id="cb7-100"><a href="modelo_unidad_ictpc.html#cb7-100" tabindex="-1"></a></span>
<span id="cb7-101"><a href="modelo_unidad_ictpc.html#cb7-101" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">modelo_ingreso</span>(</span>
<span id="cb7-102"><a href="modelo_unidad_ictpc.html#cb7-102" tabindex="-1"></a>  <span class="at">encuesta_sta =</span> encuesta_sta ,</span>
<span id="cb7-103"><a href="modelo_unidad_ictpc.html#cb7-103" tabindex="-1"></a>  <span class="at">predictors =</span> statelevel_predictors_df,</span>
<span id="cb7-104"><a href="modelo_unidad_ictpc.html#cb7-104" tabindex="-1"></a>  <span class="at">censo_sta =</span> censo_sta,</span>
<span id="cb7-105"><a href="modelo_unidad_ictpc.html#cb7-105" tabindex="-1"></a>  <span class="at">formula_mod =</span> formula_model,</span>
<span id="cb7-106"><a href="modelo_unidad_ictpc.html#cb7-106" tabindex="-1"></a>  <span class="at">byAgrega =</span> byAgrega</span>
<span id="cb7-107"><a href="modelo_unidad_ictpc.html#cb7-107" tabindex="-1"></a>)</span>
<span id="cb7-108"><a href="modelo_unidad_ictpc.html#cb7-108" tabindex="-1"></a></span>
<span id="cb7-109"><a href="modelo_unidad_ictpc.html#cb7-109" tabindex="-1"></a><span class="co">#--- Exporting Bayesian Multilevel Model Results ---#</span></span>
<span id="cb7-110"><a href="modelo_unidad_ictpc.html#cb7-110" tabindex="-1"></a></span>
<span id="cb7-111"><a href="modelo_unidad_ictpc.html#cb7-111" tabindex="-1"></a><span class="fu">saveRDS</span>(fit, </span>
<span id="cb7-112"><a href="modelo_unidad_ictpc.html#cb7-112" tabindex="-1"></a>        <span class="at">file =</span> <span class="st">&quot;../output/2020/modelos/fit_mrp_ictpc.rds&quot;</span>)</span>
<span id="cb7-113"><a href="modelo_unidad_ictpc.html#cb7-113" tabindex="-1"></a></span>
<span id="cb7-114"><a href="modelo_unidad_ictpc.html#cb7-114" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> fit<span class="sc">$</span>plot_densy,</span>
<span id="cb7-115"><a href="modelo_unidad_ictpc.html#cb7-115" tabindex="-1"></a>       <span class="st">&quot;../output/2020/plots/01_densidad_ictpc.png&quot;</span>,<span class="at">scale =</span> <span class="dv">3</span>)</span>
<span id="cb7-116"><a href="modelo_unidad_ictpc.html#cb7-116" tabindex="-1"></a>fit<span class="sc">$</span>plot_hist_post</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="validacion_encuestas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelo_unidad_py_ic_ali_nc.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/2023MEXsae/06_Modelo_unidad_ictpc.qmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.pdf", "Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.epub", "Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

</body>

</html>
