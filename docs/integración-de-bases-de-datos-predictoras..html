<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 5 Integración de bases de datos predictoras. | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024</title>
  <meta name="description" content="Manual de procesamiento." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 5 Integración de bases de datos predictoras. | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Manual de procesamiento." />
  <meta name="github-repo" content="psirusteam/coneval" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 5 Integración de bases de datos predictoras. | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024" />
  
  <meta name="twitter:description" content="Manual de procesamiento." />
  

<meta name="author" content="Andrés Gutiérrez, Stalyn Guerrero" />


<meta name="date" content="2024-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="conslidar-y-guardar-las-variables-satelitales.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Taller de instalación de capacidades en SAE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="respositodio-de-códigos.html"><a href="respositodio-de-códigos.html"><i class="fa fa-check"></i>Respositodio de códigos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="librerias-de-r-y-otros-insumos.html"><a href="librerias-de-r-y-otros-insumos.html"><i class="fa fa-check"></i><b>2</b> Librerias de <em>R</em> y otros insumos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html"><i class="fa fa-check"></i><b>2.1</b> Librerías Utilizadas</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#manipulación-y-transformación-de-datos"><i class="fa fa-check"></i><b>2.1.1</b> Manipulación y Transformación de Datos</a></li>
<li class="chapter" data-level="2.1.2" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#lectura-y-escritura-de-datos"><i class="fa fa-check"></i><b>2.1.2</b> Lectura y Escritura de Datos</a></li>
<li class="chapter" data-level="2.1.3" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#análisis-de-datos-de-encuestas"><i class="fa fa-check"></i><b>2.1.3</b> Análisis de Datos de Encuestas</a></li>
<li class="chapter" data-level="2.1.4" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#modelado-y-análisis-estadístico"><i class="fa fa-check"></i><b>2.1.4</b> Modelado y Análisis Estadístico</a></li>
<li class="chapter" data-level="2.1.5" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#visualización-de-datos"><i class="fa fa-check"></i><b>2.1.5</b> Visualización de Datos</a></li>
<li class="chapter" data-level="2.1.6" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#informes-y-reproducibilidad"><i class="fa fa-check"></i><b>2.1.6</b> Informes y Reproducibilidad</a></li>
<li class="chapter" data-level="2.1.7" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#integración-con-otros-lenguajes"><i class="fa fa-check"></i><b>2.1.7</b> Integración con Otros Lenguajes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="bases-de-datos-utilizadas.html"><a href="bases-de-datos-utilizadas.html"><i class="fa fa-check"></i><b>2.2</b> Bases de Datos Utilizadas</a></li>
<li class="chapter" data-level="2.3" data-path="estructura-del-proyecto.html"><a href="estructura-del-proyecto.html"><i class="fa fa-check"></i><b>2.3</b> Estructura del Proyecto</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lectura-y-consolidación-de-bases-de-datos.html"><a href="lectura-y-consolidación-de-bases-de-datos.html"><i class="fa fa-check"></i><b>3</b> Lectura y consolidación de bases de datos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html"><a href="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html"><i class="fa fa-check"></i><b>3.1</b> Consolidando la base de datos de la encuesta ampliada del censo</a>
<ul>
<li class="chapter" data-level="" data-path="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html"><a href="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html#limpieza-del-espacio-de-trabajo"><i class="fa fa-check"></i>Limpieza del espacio de trabajo</a></li>
<li class="chapter" data-level="" data-path="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html"><a href="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html#carga-de-bibliotecas"><i class="fa fa-check"></i>Carga de bibliotecas</a></li>
<li class="chapter" data-level="" data-path="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html"><a href="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html#definición-de-variables-para-validación"><i class="fa fa-check"></i>Definición de variables para validación</a></li>
<li class="chapter" data-level="" data-path="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html"><a href="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html#obtener-la-lista-de-archivos-.dta"><i class="fa fa-check"></i>Obtener la lista de archivos .dta</a></li>
<li class="chapter" data-level="" data-path="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html"><a href="consolidando-la-base-de-datos-de-la-encuesta-ampliada-del-censo.html#conslidar-bases-de-la-muestra-ampliada"><i class="fa fa-check"></i>Conslidar bases de la muestra ampliada</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="cambiando-de-formato-.dta-a-.rds-la-base-de-la-enigh..html"><a href="cambiando-de-formato-.dta-a-.rds-la-base-de-la-enigh..html"><i class="fa fa-check"></i><b>3.2</b> Cambiando de formato .dta a .rds la base de la ENIGH.</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="proceso-para-la-descarga-de-imágenes-satelitales.html"><a href="proceso-para-la-descarga-de-imágenes-satelitales.html"><i class="fa fa-check"></i><b>4</b> Proceso para la descarga de imágenes satelitales</a>
<ul>
<li class="chapter" data-level="4.1" data-path="configurar-el-entorno-de-r.html"><a href="configurar-el-entorno-de-r.html"><i class="fa fa-check"></i><b>4.1</b> Configurar el entorno de <em>R</em></a></li>
<li class="chapter" data-level="4.2" data-path="preparación-de-la-shapefile.html"><a href="preparación-de-la-shapefile.html"><i class="fa fa-check"></i><b>4.2</b> Preparación de la <strong>Shapefile</strong></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="preparación-de-la-shapefile.html"><a href="preparación-de-la-shapefile.html#definición-del-sistema-de-referencia-espacial"><i class="fa fa-check"></i><b>4.2.1</b> Definición del Sistema de Referencia Espacial</a></li>
<li class="chapter" data-level="4.2.2" data-path="preparación-de-la-shapefile.html"><a href="preparación-de-la-shapefile.html#transformación-y-combinación-de-shapefiles"><i class="fa fa-check"></i><b>4.2.2</b> Transformación y Combinación de Shapefiles</a></li>
<li class="chapter" data-level="4.2.3" data-path="preparación-de-la-shapefile.html"><a href="preparación-de-la-shapefile.html#corrección-de-la-codificación-de-los-nombres-geográficos"><i class="fa fa-check"></i><b>4.2.3</b> Corrección de la Codificación de los Nombres Geográficos</a></li>
<li class="chapter" data-level="4.2.4" data-path="preparación-de-la-shapefile.html"><a href="preparación-de-la-shapefile.html#guardado-del-shapefile-transformado"><i class="fa fa-check"></i><b>4.2.4</b> Guardado del Shapefile Transformado</a></li>
<li class="chapter" data-level="4.2.5" data-path="preparación-de-la-shapefile.html"><a href="preparación-de-la-shapefile.html#limpieza-del-espacio-de-trabajo-1"><i class="fa fa-check"></i><b>4.2.5</b> Limpieza del Espacio de Trabajo</a></li>
<li class="chapter" data-level="4.2.6" data-path="preparación-de-la-shapefile.html"><a href="preparación-de-la-shapefile.html#lectura-de-shapefile-transformado"><i class="fa fa-check"></i><b>4.2.6</b> Lectura de Shapefile Transformado</a></li>
<li class="chapter" data-level="4.2.7" data-path="preparación-de-la-shapefile.html"><a href="preparación-de-la-shapefile.html#cobertura-urbana-y-uso-del-suelo"><i class="fa fa-check"></i><b>4.2.7</b> Cobertura urbana y uso del suelo</a></li>
<li class="chapter" data-level="4.2.8" data-path="preparación-de-la-shapefile.html"><a href="preparación-de-la-shapefile.html#distancia-a-hospitales"><i class="fa fa-check"></i><b>4.2.8</b> Distancia a hospitales</a></li>
<li class="chapter" data-level="4.2.9" data-path="preparación-de-la-shapefile.html"><a href="preparación-de-la-shapefile.html#global-human-modification-ghm"><i class="fa fa-check"></i><b>4.2.9</b> Global Human Modification (GHM)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="conslidar-y-guardar-las-variables-satelitales.html"><a href="conslidar-y-guardar-las-variables-satelitales.html"><i class="fa fa-check"></i><b>4.3</b> Conslidar y guardar las variables satelitales</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="integración-de-bases-de-datos-predictoras..html"><a href="integración-de-bases-de-datos-predictoras..html"><i class="fa fa-check"></i><b>5</b> Integración de bases de datos predictoras.</a></li>
<li class="divider"></li>
<li><a Taller de instalación de capacidades en SAE </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="integración-de-bases-de-datos-predictoras." class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Capítulo 5</span> Integración de bases de datos predictoras.<a href="integración-de-bases-de-datos-predictoras..html#integración-de-bases-de-datos-predictoras." class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Este código se centra en la selección y procesamiento de variables de covariables a nivel municipal para el año 2020. A continuación, se describe cada bloque del código en términos generales.</p>
<div id="limpieza-del-entorno-de-r" class="section level4 unnumbered hasAnchor">
<h4>Limpieza del Entorno de R<a href="integración-de-bases-de-datos-predictoras..html#limpieza-del-entorno-de-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Para asegurar un entorno limpio y evitar conflictos con datos previos, se eliminan todas las variables existentes en el entorno de R usando <code>rm(list = ls())</code>. Esto permite que el análisis comience sin datos residuales que puedan interferir.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="integración-de-bases-de-datos-predictoras..html#cb28-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="carga-de-librerías" class="section level4 unnumbered hasAnchor">
<h4>Carga de librerías<a href="integración-de-bases-de-datos-predictoras..html#carga-de-librerías" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Se cargan varias librerías esenciales para la manipulación y análisis de datos. <code>tidyverse</code> se utiliza para la manipulación de datos y visualización; <code>data.table</code> para trabajar con grandes conjuntos de datos en formato de tabla; <code>openxlsx</code> para la lectura y escritura de archivos Excel; <code>magrittr</code> proporciona el operador de tubería (<code>%&gt;%</code>) para una sintaxis más clara; <code>DataExplorer</code> ayuda en la exploración y visualización de datos; <code>haven</code> permite la importación de archivos de datos en formatos como Stata; <code>purrr</code> se utiliza para aplicar funciones a listas y vectores; y <code>labelled</code> facilita el manejo de variables etiquetadas. Finalmente, <code>cat("\f")</code> limpia la consola para un entorno de trabajo más ordenado.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="integración-de-bases-de-datos-predictoras..html#cb29-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb29-2"><a href="integración-de-bases-de-datos-predictoras..html#cb29-2" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb29-3"><a href="integración-de-bases-de-datos-predictoras..html#cb29-3" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb29-4"><a href="integración-de-bases-de-datos-predictoras..html#cb29-4" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb29-5"><a href="integración-de-bases-de-datos-predictoras..html#cb29-5" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb29-6"><a href="integración-de-bases-de-datos-predictoras..html#cb29-6" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb29-7"><a href="integración-de-bases-de-datos-predictoras..html#cb29-7" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb29-8"><a href="integración-de-bases-de-datos-predictoras..html#cb29-8" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb29-9"><a href="integración-de-bases-de-datos-predictoras..html#cb29-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\f</span><span class="st">&quot;</span>)</span></code></pre></div>
<div style="page-break-after: always;"></div>
</div>
<div id="lectura-de-bases-de-datos-de-contexto" class="section level4 unnumbered hasAnchor">
<h4>Lectura de Bases de Datos de Contexto<a href="integración-de-bases-de-datos-predictoras..html#lectura-de-bases-de-datos-de-contexto" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La sección de lectura de bases de datos comienza cargando los datos satelitales desde un archivo RDS. Posteriormente, se extraen los códigos municipales únicos de esta base de datos, lo que permite identificar todos los municipios representados en los datos satelitales.</p>
<p>Luego, se carga la base de datos “Contexto_mun20” en formato Stata, que contiene información de diversas variables a nivel municipal. Al convertir estas variables en factores y revisar el número de categorías distintas en cada una, se puede entender mejor la estructura de los datos. Este paso es crucial para preparar los datos para el análisis posterior.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="integración-de-bases-de-datos-predictoras..html#cb30-1" tabindex="-1"></a>satelital <span class="ot">&lt;-</span></span>
<span id="cb30-2"><a href="integración-de-bases-de-datos-predictoras..html#cb30-2" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="st">&quot;../input/2020/predictores/statelevel_predictors_satelite.rds&quot;</span>) </span>
<span id="cb30-3"><a href="integración-de-bases-de-datos-predictoras..html#cb30-3" tabindex="-1"></a></span>
<span id="cb30-4"><a href="integración-de-bases-de-datos-predictoras..html#cb30-4" tabindex="-1"></a><span class="co"># Obtener los códigos municipales únicos de la base de datos satelital</span></span>
<span id="cb30-5"><a href="integración-de-bases-de-datos-predictoras..html#cb30-5" tabindex="-1"></a>cod_mun <span class="ot">&lt;-</span> satelital <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(cve_mun)</span>
<span id="cb30-6"><a href="integración-de-bases-de-datos-predictoras..html#cb30-6" tabindex="-1"></a></span>
<span id="cb30-7"><a href="integración-de-bases-de-datos-predictoras..html#cb30-7" tabindex="-1"></a><span class="co"># Cargar la base de datos &quot;Contexto_mun20&quot; en formato Stata y renombrar la columna &quot;CVEGEO&quot; a &quot;cve_mun&quot;</span></span>
<span id="cb30-8"><a href="integración-de-bases-de-datos-predictoras..html#cb30-8" tabindex="-1"></a>Contexto_mun <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">&quot;../input/2020/predictores/contexto_2020.dta&quot;</span>)</span>
<span id="cb30-9"><a href="integración-de-bases-de-datos-predictoras..html#cb30-9" tabindex="-1"></a>Contexto_mun <span class="sc">%&gt;%</span> <span class="fu">as_factor</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb30-10"><a href="integración-de-bases-de-datos-predictoras..html#cb30-10" tabindex="-1"></a>  <span class="fu">apply</span>(., <span class="dv">2</span>, n_distinct) <span class="sc">%&gt;%</span> <span class="fu">sort</span>()</span></code></pre></div>
<pre><code>##             elec_mun19             elec_mun20                   smg1 
##                      2                      2                      2 
##        ql_porc_cpa_urb        ql_porc_cpa_rur         dec_geologicas 
##                      5                      6                      9 
##         dec_hidrometeo            vabpc_15_19            desem_15_20 
##                     20                     32                     32 
##     transf_gobpc_15_20           itlpis_15_20       derhab_pea_15_20 
##                     32                     32                     32 
##          remespc_15_20            acc_muybajo              acc_medio 
##                     32                    275                    887 
##            prop_sucban        prop_hospitales          edad65mas_urb 
##                   1236                   1248                   1272 
##          edad65mas_rur            altitud1000         porc_10sal_urb 
##                   1429                   1447                   1478 
##            pob_ind_urb         porc_10sal_rur          TasaDesempurb 
##                   1591                   1614                   1617 
##                pob_urb porc_patnoagrnocal_urb               porc_rur 
##                   1619                   1626                   1632 
##               porc_urb         porc_cpagr_urb    porc_hogremesas_urb 
##                   1632                   1647                   1652 
##           porc_jub_urb                 po_urb            porc_expurb 
##                   1652                   1656                   1656 
##     porc_norep_ing_urb      porc_hogayotr_urb      porc_ing_ilpi_urb 
##                   1656                   1657                   1658 
##     porc_ic_asalud_urb     porc_hogprogob_urb       prom_esc_rel_urb 
##                   1658                   1659                   1659 
##               acc_alto              edad65mas porc_patnoagrnocal_rur 
##                   1826                   1883                   2005 
##               acc_bajo          TasaDesemprur            pob_ind_rur 
##                   2024                   2084                   2168 
##                pob_rur           porc_jub_rur    porc_hogremesas_rur 
##                   2264                   2310                   2319 
##            acc_muyalto      porc_hogayotr_rur         porc_cpagr_rur 
##                   2331                   2343                   2345 
##            porc_exprur     porc_norep_ing_rur            t_incdelic1 
##                   2356                   2368                   2382 
##      porc_ing_ilpi_rur                pob_tot             prop_clues 
##                   2386                   2390                   2401 
##                 po_rur     porc_hogprogob_rur     porc_ic_asalud_rur 
##                   2405                   2408                   2417 
##       prom_esc_rel_rur          porc_segsoc15                gini15m 
##                   2439                   2449                   2451 
##             porc_ali15                  plp15                ictpc15 
##                   2452                   2452                   2453 
##                cve_mun 
##                   2466</code></pre>
</div>
<div id="procesamiento-y-escalado-de-variables" class="section level4 unnumbered hasAnchor">
<h4>Procesamiento y Escalado de Variables<a href="integración-de-bases-de-datos-predictoras..html#procesamiento-y-escalado-de-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En esta sección, el código procesa la base de datos <code>Contexto_mun</code> para asegurar que las variables categóricas sean correctamente identificadas y que las variables numéricas sean escaladas. Primero, se convierte toda la base de datos a factores usando <code>as_factor()</code>. Luego, se seleccionan variables específicas (<code>elec_mun19</code>, <code>elec_mun20</code>, <code>smg1</code>, <code>ql_porc_cpa_urb</code>, <code>ql_porc_cpa_rur</code>, <code>dec_geologicas</code>, <code>dec_hidrometeo</code>) y se aseguran que se manejen como factores. Además, cualquier columna numérica se escala usando <code>scale()</code>, lo que transforma estas variables para que tengan media cero y desviación estándar uno.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="integración-de-bases-de-datos-predictoras..html#cb32-1" tabindex="-1"></a>Contexto_mun <span class="sc">%&lt;&gt;%</span> <span class="fu">as_factor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="integración-de-bases-de-datos-predictoras..html#cb32-2" tabindex="-1"></a>  <span class="fu">mutate_at</span>(</span>
<span id="cb32-3"><a href="integración-de-bases-de-datos-predictoras..html#cb32-3" tabindex="-1"></a>    <span class="at">.vars =</span> <span class="fu">c</span>(</span>
<span id="cb32-4"><a href="integración-de-bases-de-datos-predictoras..html#cb32-4" tabindex="-1"></a>      <span class="st">&quot;elec_mun19&quot;</span>,</span>
<span id="cb32-5"><a href="integración-de-bases-de-datos-predictoras..html#cb32-5" tabindex="-1"></a>      <span class="st">&quot;elec_mun20&quot;</span>,</span>
<span id="cb32-6"><a href="integración-de-bases-de-datos-predictoras..html#cb32-6" tabindex="-1"></a>      <span class="st">&quot;smg1&quot;</span>,</span>
<span id="cb32-7"><a href="integración-de-bases-de-datos-predictoras..html#cb32-7" tabindex="-1"></a>      <span class="st">&quot;ql_porc_cpa_urb&quot;</span>,</span>
<span id="cb32-8"><a href="integración-de-bases-de-datos-predictoras..html#cb32-8" tabindex="-1"></a>      <span class="st">&quot;ql_porc_cpa_rur&quot;</span>,</span>
<span id="cb32-9"><a href="integración-de-bases-de-datos-predictoras..html#cb32-9" tabindex="-1"></a>      <span class="st">&quot;dec_geologicas&quot;</span>,</span>
<span id="cb32-10"><a href="integración-de-bases-de-datos-predictoras..html#cb32-10" tabindex="-1"></a>      <span class="st">&quot;dec_hidrometeo&quot;</span></span>
<span id="cb32-11"><a href="integración-de-bases-de-datos-predictoras..html#cb32-11" tabindex="-1"></a>    ),</span>
<span id="cb32-12"><a href="integración-de-bases-de-datos-predictoras..html#cb32-12" tabindex="-1"></a>    as.factor</span>
<span id="cb32-13"><a href="integración-de-bases-de-datos-predictoras..html#cb32-13" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-14"><a href="integración-de-bases-de-datos-predictoras..html#cb32-14" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, <span class="cf">function</span>(x)</span>
<span id="cb32-15"><a href="integración-de-bases-de-datos-predictoras..html#cb32-15" tabindex="-1"></a>    <span class="fu">as.numeric</span>(<span class="fu">scale</span>(x)))</span></code></pre></div>
</div>
<div id="identificación-de-códigos-municipales-faltantes" class="section level4 unnumbered hasAnchor">
<h4>Identificación de Códigos Municipales Faltantes<a href="integración-de-bases-de-datos-predictoras..html#identificación-de-códigos-municipales-faltantes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El siguiente paso implica una <code>anti_join</code> entre <code>cod_mun</code> y <code>Contexto_mun</code>. Esto permite identificar los códigos municipales presentes en la base de datos satelital que no están presentes en <code>Contexto_mun</code>. Esta operación es útil para detectar inconsistencias o faltantes en los datos municipales que podrían impactar en los análisis posteriores.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="integración-de-bases-de-datos-predictoras..html#cb33-1" tabindex="-1"></a><span class="fu">anti_join</span>(cod_mun, Contexto_mun) <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="integración-de-bases-de-datos-predictoras..html#cb33-2" tabindex="-1"></a>  <span class="fu">tba</span>(<span class="at">cap =</span> <span class="st">&quot;Tabla de municipios sin información&quot;</span>)</span></code></pre></div>
<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-6">Tabla 5.1: </span>Tabla de municipios sin información
</caption>
<thead>
<tr>
<th style="text-align:left;">
cve_mun
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
04012
</td>
</tr>
<tr>
<td style="text-align:left;">
07125
</td>
</tr>
<tr>
<td style="text-align:left;">
29048
</td>
</tr>
</tbody>
</table>
</div>
<div id="verificación-de-columnas-completas" class="section level4 unnumbered hasAnchor">
<h4>Verificación de Columnas Completas<a href="integración-de-bases-de-datos-predictoras..html#verificación-de-columnas-completas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Para garantizar que sólo se utilicen columnas sin valores faltantes, se aplica una función que verifica si alguna columna en <code>Contexto_mun</code> tiene valores <code>NA</code>. El resultado es almacenado en <code>paso</code>, y la frecuencia de columnas completas es mostrada con <code>table(paso)</code>. Este paso asegura que las columnas usadas en el análisis posterior están completas y no contienen datos faltantes.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="integración-de-bases-de-datos-predictoras..html#cb34-1" tabindex="-1"></a>paso <span class="ot">&lt;-</span> <span class="fu">apply</span>(Contexto_mun, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="sc">!</span><span class="fu">any</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb34-2"><a href="integración-de-bases-de-datos-predictoras..html#cb34-2" tabindex="-1"></a><span class="fu">table</span>(paso)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">FALSE</th>
<th align="right">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">65</td>
</tr>
</tbody>
</table>
</div>
<div id="combinación-de-bases-de-datos" class="section level4 unnumbered hasAnchor">
<h4>Combinación de Bases de Datos<a href="integración-de-bases-de-datos-predictoras..html#combinación-de-bases-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Se realiza una <code>inner_join</code> entre las bases de datos <code>satelital</code> y <code>Contexto_mun</code>, utilizando únicamente las columnas sin valores faltantes identificadas previamente. Esta combinación asegura que se unan únicamente los datos completos de ambas bases, resultando en una base de datos consolidada <code>statelevel_predictors</code>. Las dimensiones de esta nueva base de datos se obtienen usando <code>dim(statelevel_predictors)</code>, proporcionando información sobre el tamaño de los datos resultantes.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="integración-de-bases-de-datos-predictoras..html#cb35-1" tabindex="-1"></a>statelevel_predictors <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(satelital, Contexto_mun[, paso])</span>
<span id="cb35-2"><a href="integración-de-bases-de-datos-predictoras..html#cb35-2" tabindex="-1"></a><span class="fu">dim</span>(statelevel_predictors)</span></code></pre></div>
<pre><code>## [1] 2466   72</code></pre>
</div>
<div id="guardado-de-la-base-de-datos-final" class="section level4 unnumbered hasAnchor">
<h4>Guardado de la Base de Datos Final<a href="integración-de-bases-de-datos-predictoras..html#guardado-de-la-base-de-datos-final" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finalmente, la base de datos consolidada <code>statelevel_predictors</code> se guarda en un archivo RDS para su uso posterior, utilizando <code>saveRDS()</code>. Este archivo es almacenado en la ruta especificada, permitiendo que los datos procesados estén disponibles para futuros análisis sin necesidad de repetir los pasos de limpieza y combinación.</p>
<p>```{r. eval = FALSE}
saveRDS(statelevel_predictors,file = “../input/2020/predictores/statelevel_predictors_df.rds”)</p>
<p>```</p>

</div>
</div>







            </section>

          </div>
        </div>
      </div>
<a href="conslidar-y-guardar-las-variables-satelitales.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/2023MEXsae/02_Union_predictores.qmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.pdf", "Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.epub", "Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

</body>

</html>
