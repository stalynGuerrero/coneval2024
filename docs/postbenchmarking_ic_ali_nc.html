<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 11 10_PostBenchmarking_ic_ali_nc.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024</title>
  <meta name="description" content="Manual de procesamiento." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 11 10_PostBenchmarking_ic_ali_nc.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Manual de procesamiento." />
  <meta name="github-repo" content="psirusteam/coneval" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 11 10_PostBenchmarking_ic_ali_nc.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024" />
  
  <meta name="twitter:description" content="Manual de procesamiento." />
  

<meta name="author" content="Andrés Gutiérrez, Stalyn Guerrero" />


<meta name="date" content="2024-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="postbenchmarking_ictpc.html"/>
<link rel="next" href="postbenchmarking_ic_segsoc.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Taller de instalación de capacidades en SAE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="respositodio-de-códigos.html"><a href="respositodio-de-códigos.html"><i class="fa fa-check"></i>Respositodio de códigos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="librerias-de-r-y-otros-insumos.html"><a href="librerias-de-r-y-otros-insumos.html"><i class="fa fa-check"></i>Librerias de <em>R</em> y otros insumos</a>
<ul>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html"><i class="fa fa-check"></i>Librerías Utilizadas</a>
<ul>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#manipulación-y-transformación-de-datos"><i class="fa fa-check"></i>Manipulación y Transformación de Datos</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#lectura-y-escritura-de-datos"><i class="fa fa-check"></i>Lectura y Escritura de Datos</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#análisis-de-datos-de-encuestas"><i class="fa fa-check"></i>Análisis de Datos de Encuestas</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#modelado-y-análisis-estadístico"><i class="fa fa-check"></i>Modelado y Análisis Estadístico</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#visualización-de-datos"><i class="fa fa-check"></i>Visualización de Datos</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#informes-y-reproducibilidad"><i class="fa fa-check"></i>Informes y Reproducibilidad</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#integración-con-otros-lenguajes"><i class="fa fa-check"></i>Integración con Otros Lenguajes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bases-de-datos-utilizadas.html"><a href="bases-de-datos-utilizadas.html"><i class="fa fa-check"></i>Bases de Datos Utilizadas</a></li>
<li class="chapter" data-level="" data-path="estructura-del-proyecto.html"><a href="estructura-del-proyecto.html"><i class="fa fa-check"></i>Estructura del Proyecto</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="union_bases.html"><a href="union_bases.html"><i class="fa fa-check"></i><b>1</b> 00_union_bases.R</a></li>
<li class="chapter" data-level="2" data-path="descarga_satelitales.html"><a href="descarga_satelitales.html"><i class="fa fa-check"></i><b>2</b> 01_Descarga_satelitales.R</a></li>
<li class="chapter" data-level="3" data-path="union_predictores.html"><a href="union_predictores.html"><i class="fa fa-check"></i><b>3</b> 02_Union_predictores.R</a></li>
<li class="chapter" data-level="4" data-path="estandarizar_muestra_cuestionario_ampliado.html"><a href="estandarizar_muestra_cuestionario_ampliado.html"><i class="fa fa-check"></i><b>4</b> 03_Estandarizar_muestra_cuestionario_ampliado.R</a></li>
<li class="chapter" data-level="5" data-path="armonizar_encuesta.html"><a href="armonizar_encuesta.html"><i class="fa fa-check"></i><b>5</b> 04_Armonizar_encuesta.R</a></li>
<li class="chapter" data-level="6" data-path="validacion_encuestas.html"><a href="validacion_encuestas.html"><i class="fa fa-check"></i><b>6</b> 05_Validacion_encuestas.R</a></li>
<li class="chapter" data-level="7" data-path="modelo_unidad_ictpc.html"><a href="modelo_unidad_ictpc.html"><i class="fa fa-check"></i><b>7</b> 06_Modelo_unidad_ictpc.R</a></li>
<li class="chapter" data-level="8" data-path="modelo_unidad_py_ic_ali_nc.html"><a href="modelo_unidad_py_ic_ali_nc.html"><i class="fa fa-check"></i><b>8</b> 07_Modelo_unidad_py_ic_ali_nc.R</a></li>
<li class="chapter" data-level="9" data-path="modelo_unidad_py_ic_segsoc.html"><a href="modelo_unidad_py_ic_segsoc.html"><i class="fa fa-check"></i><b>9</b> 08_Modelo_unidad_py_ic_segsoc</a></li>
<li class="chapter" data-level="10" data-path="postbenchmarking_ictpc.html"><a href="postbenchmarking_ictpc.html"><i class="fa fa-check"></i><b>10</b> 09_PostBenchmarking_ictpc.R</a></li>
<li class="chapter" data-level="11" data-path="postbenchmarking_ic_ali_nc.html"><a href="postbenchmarking_ic_ali_nc.html"><i class="fa fa-check"></i><b>11</b> 10_PostBenchmarking_ic_ali_nc.R</a></li>
<li class="chapter" data-level="12" data-path="postbenchmarking_ic_segsoc.html"><a href="postbenchmarking_ic_segsoc.html"><i class="fa fa-check"></i><b>12</b> 11_PostBenchmarking_ic_segsoc.r</a></li>
<li class="chapter" data-level="13" data-path="imputacion_censal.html"><a href="imputacion_censal.html"><i class="fa fa-check"></i><b>13</b> 12_Imputacion_censal.R</a></li>
<li class="chapter" data-level="14" data-path="estimacion_ent_02.html"><a href="estimacion_ent_02.html"><i class="fa fa-check"></i><b>14</b> 13_Estimacion_ent_02.R</a></li>
<li class="chapter" data-level="15" data-path="estimacion_municipios_ipm_pobreza.html"><a href="estimacion_municipios_ipm_pobreza.html"><i class="fa fa-check"></i><b>15</b> 14_estimacion_municipios_ipm_pobreza.R</a></li>
<li class="chapter" data-level="16" data-path="estimacion_municipios_ipm_pobreza_error.html"><a href="estimacion_municipios_ipm_pobreza_error.html"><i class="fa fa-check"></i><b>16</b> 15_estimacion_municipios_ipm_pobreza_error.R</a></li>
<li class="chapter" data-level="17" data-path="mapas.html"><a href="mapas.html"><i class="fa fa-check"></i><b>17</b> 16_Mapas.R</a></li>
<li class="chapter" data-level="18" data-path="estimacion_municipios_carencias.html"><a href="estimacion_municipios_carencias.html"><i class="fa fa-check"></i><b>18</b> 17_estimacion_municipios_carencias.R</a></li>
<li class="chapter" data-level="19" data-path="estimacion_municipios_carencias_error.html"><a href="estimacion_municipios_carencias_error.html"><i class="fa fa-check"></i><b>19</b> 18_estimacion_municipios_carencias_error.R</a></li>
<li class="chapter" data-level="20" data-path="mapas_carencias.html"><a href="mapas_carencias.html"><i class="fa fa-check"></i><b>20</b> 19_Mapas_carencias.R</a></li>
<li class="divider"></li>
<li><a Taller de instalación de capacidades en SAE </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="postbenchmarking_ic_ali_nc.r" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Capítulo 11</span> 10_PostBenchmarking_ic_ali_nc.R<a href="postbenchmarking_ic_ali_nc.html#postbenchmarking_ic_ali_nc.r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Para la ejecución del presente archivo, debe abrir el archivo <strong>10_PostBenchmarking_ic_ali_nc.R</strong> disponible en la ruta <em>Rcodes/2020/10_PostBenchmarking_ic_ali_nc.R</em>.</p>
<p>Este script en R se centra en la validación y benchmarking de un modelo multinivel para predecir la carencia en alimentos nutritivos y de calidad (ic_ali_nc) utilizando datos de encuestas y censos. Comienza limpiando el entorno de trabajo y cargando librerías necesarias. Además, se leen funciones auxiliares desde archivos externos para la validación y el benchmarking. Luego, se carga el modelo preentrenado desde un archivo RDS.</p>
<p>El proceso de benchmarking se realiza con la función <code>benchmarking</code>, utilizando covariables específicas como <code>ent</code>, <code>area</code>, <code>sexo</code>, <code>edad</code>, <code>discapacidad</code> y <code>hlengua</code>, y aplicando el método “logit”. Los resultados se almacenan en <code>list_bench</code>. A continuación, se crea un diseño de encuesta y se realizan validaciones a nivel nacional comparando los resultados del modelo ajustado (<code>yk_stan_lmer</code>) y del modelo ajustado con benchmarking (<code>yk_bench</code>). Estas validaciones se llevan a cabo mediante la comparación de medias ponderadas.</p>
<p>Para validar el modelo a nivel de subgrupos, se definen diversos subgrupos como <code>ent</code>, <code>area</code>, <code>sexo</code>, <code>edad</code>, <code>discapacidad</code>, <code>hlengua</code> y <code>nivel_edu</code>. Se crean gráficos de validación para cada subgrupo utilizando la función <code>plot_uni_validacion</code>. Estos gráficos se combinan y se guardan en un archivo JPG (<code>plot_uni_ic_ali_nc.jpg</code>). Además, se guarda la lista de gráficos y el dataframe postestratificado en archivos RDS (<code>plot_uni_ic_ali_nc.rds</code> y <code>poststrat_df_ic_ali_nc.rds</code> respectivamente), lo que permite una fácil recuperación y análisis posterior.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="postbenchmarking_ic_ali_nc.html#cb11-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>())</span>
<span id="cb11-2"><a href="postbenchmarking_ic_ali_nc.html#cb11-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\f</span><span class="st">&quot;</span>)</span>
<span id="cb11-3"><a href="postbenchmarking_ic_ali_nc.html#cb11-3" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb11-4"><a href="postbenchmarking_ic_ali_nc.html#cb11-4" tabindex="-1"></a><span class="co"># Loading required libraries ----------------------------------------------</span></span>
<span id="cb11-5"><a href="postbenchmarking_ic_ali_nc.html#cb11-5" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb11-6"><a href="postbenchmarking_ic_ali_nc.html#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="postbenchmarking_ic_ali_nc.html#cb11-7" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb11-8"><a href="postbenchmarking_ic_ali_nc.html#cb11-8" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb11-9"><a href="postbenchmarking_ic_ali_nc.html#cb11-9" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span>
<span id="cb11-10"><a href="postbenchmarking_ic_ali_nc.html#cb11-10" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb11-11"><a href="postbenchmarking_ic_ali_nc.html#cb11-11" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb11-12"><a href="postbenchmarking_ic_ali_nc.html#cb11-12" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb11-13"><a href="postbenchmarking_ic_ali_nc.html#cb11-13" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-14"><a href="postbenchmarking_ic_ali_nc.html#cb11-14" tabindex="-1"></a></span>
<span id="cb11-15"><a href="postbenchmarking_ic_ali_nc.html#cb11-15" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb11-16"><a href="postbenchmarking_ic_ali_nc.html#cb11-16" tabindex="-1"></a><span class="co"># Lectura de funciones </span></span>
<span id="cb11-17"><a href="postbenchmarking_ic_ali_nc.html#cb11-17" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb11-18"><a href="postbenchmarking_ic_ali_nc.html#cb11-18" tabindex="-1"></a></span>
<span id="cb11-19"><a href="postbenchmarking_ic_ali_nc.html#cb11-19" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;../source/Plot_validacion_bench.R&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb11-20"><a href="postbenchmarking_ic_ali_nc.html#cb11-20" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;../source/Benchmarking.R&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb11-21"><a href="postbenchmarking_ic_ali_nc.html#cb11-21" tabindex="-1"></a></span>
<span id="cb11-22"><a href="postbenchmarking_ic_ali_nc.html#cb11-22" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb11-23"><a href="postbenchmarking_ic_ali_nc.html#cb11-23" tabindex="-1"></a><span class="co"># Lectura del modelo </span></span>
<span id="cb11-24"><a href="postbenchmarking_ic_ali_nc.html#cb11-24" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb11-25"><a href="postbenchmarking_ic_ali_nc.html#cb11-25" tabindex="-1"></a></span>
<span id="cb11-26"><a href="postbenchmarking_ic_ali_nc.html#cb11-26" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;../output/2020/modelos/fit_mrp_ic_ali_nc.rds&quot;</span>)</span>
<span id="cb11-27"><a href="postbenchmarking_ic_ali_nc.html#cb11-27" tabindex="-1"></a></span>
<span id="cb11-28"><a href="postbenchmarking_ic_ali_nc.html#cb11-28" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb11-29"><a href="postbenchmarking_ic_ali_nc.html#cb11-29" tabindex="-1"></a><span class="co"># proceso de benchmarking</span></span>
<span id="cb11-30"><a href="postbenchmarking_ic_ali_nc.html#cb11-30" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb11-31"><a href="postbenchmarking_ic_ali_nc.html#cb11-31" tabindex="-1"></a></span>
<span id="cb11-32"><a href="postbenchmarking_ic_ali_nc.html#cb11-32" tabindex="-1"></a>list_bench <span class="ot">&lt;-</span> <span class="fu">benchmarking</span>(<span class="at">modelo =</span> fit,</span>
<span id="cb11-33"><a href="postbenchmarking_ic_ali_nc.html#cb11-33" tabindex="-1"></a>             <span class="at">names_cov =</span>   <span class="fu">c</span>(<span class="st">&quot;ent&quot;</span>,</span>
<span id="cb11-34"><a href="postbenchmarking_ic_ali_nc.html#cb11-34" tabindex="-1"></a>                             <span class="st">&quot;area&quot;</span>,</span>
<span id="cb11-35"><a href="postbenchmarking_ic_ali_nc.html#cb11-35" tabindex="-1"></a>                             <span class="st">&quot;sexo&quot;</span>,</span>
<span id="cb11-36"><a href="postbenchmarking_ic_ali_nc.html#cb11-36" tabindex="-1"></a>                             <span class="st">&quot;edad&quot;</span>,</span>
<span id="cb11-37"><a href="postbenchmarking_ic_ali_nc.html#cb11-37" tabindex="-1"></a>                             <span class="st">&quot;discapacidad&quot;</span>,</span>
<span id="cb11-38"><a href="postbenchmarking_ic_ali_nc.html#cb11-38" tabindex="-1"></a>                             <span class="st">&quot;hlengua&quot;</span>),                      </span>
<span id="cb11-39"><a href="postbenchmarking_ic_ali_nc.html#cb11-39" tabindex="-1"></a>             <span class="at">metodo =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb11-40"><a href="postbenchmarking_ic_ali_nc.html#cb11-40" tabindex="-1"></a></span>
<span id="cb11-41"><a href="postbenchmarking_ic_ali_nc.html#cb11-41" tabindex="-1"></a></span>
<span id="cb11-42"><a href="postbenchmarking_ic_ali_nc.html#cb11-42" tabindex="-1"></a><span class="do">##############################################################</span></span>
<span id="cb11-43"><a href="postbenchmarking_ic_ali_nc.html#cb11-43" tabindex="-1"></a><span class="do">## Validaciones y plot uni </span></span>
<span id="cb11-44"><a href="postbenchmarking_ic_ali_nc.html#cb11-44" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb11-45"><a href="postbenchmarking_ic_ali_nc.html#cb11-45" tabindex="-1"></a></span>
<span id="cb11-46"><a href="postbenchmarking_ic_ali_nc.html#cb11-46" tabindex="-1"></a>poststrat_df <span class="ot">&lt;-</span> fit<span class="sc">$</span>poststrat_df <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb11-47"><a href="postbenchmarking_ic_ali_nc.html#cb11-47" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yk_stan_lmer =</span> yk,</span>
<span id="cb11-48"><a href="postbenchmarking_ic_ali_nc.html#cb11-48" tabindex="-1"></a>         <span class="at">gk_bench =</span> list_bench<span class="sc">$</span>gk_bench,</span>
<span id="cb11-49"><a href="postbenchmarking_ic_ali_nc.html#cb11-49" tabindex="-1"></a>         <span class="at">yk_bench =</span> yk <span class="sc">*</span> gk_bench )</span>
<span id="cb11-50"><a href="postbenchmarking_ic_ali_nc.html#cb11-50" tabindex="-1"></a></span>
<span id="cb11-51"><a href="postbenchmarking_ic_ali_nc.html#cb11-51" tabindex="-1"></a>diseno_encuesta <span class="ot">&lt;-</span> fit<span class="sc">$</span>encuesta_mrp <span class="sc">%&gt;%</span> </span>
<span id="cb11-52"><a href="postbenchmarking_ic_ali_nc.html#cb11-52" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yk_dir =</span> yk) <span class="sc">%&gt;%</span> </span>
<span id="cb11-53"><a href="postbenchmarking_ic_ali_nc.html#cb11-53" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(<span class="at">weights =</span> fep)</span>
<span id="cb11-54"><a href="postbenchmarking_ic_ali_nc.html#cb11-54" tabindex="-1"></a></span>
<span id="cb11-55"><a href="postbenchmarking_ic_ali_nc.html#cb11-55" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">predict</span>(fit<span class="sc">$</span>fit_mrp,<span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span>
<span id="cb11-56"><a href="postbenchmarking_ic_ali_nc.html#cb11-56" tabindex="-1"></a><span class="fu">mean</span>(diseno_encuesta<span class="sc">$</span>variables<span class="sc">$</span>yk)</span>
<span id="cb11-57"><a href="postbenchmarking_ic_ali_nc.html#cb11-57" tabindex="-1"></a></span>
<span id="cb11-58"><a href="postbenchmarking_ic_ali_nc.html#cb11-58" tabindex="-1"></a><span class="do">## validación nacional.</span></span>
<span id="cb11-59"><a href="postbenchmarking_ic_ali_nc.html#cb11-59" tabindex="-1"></a><span class="fu">cbind</span>(</span>
<span id="cb11-60"><a href="postbenchmarking_ic_ali_nc.html#cb11-60" tabindex="-1"></a>  diseno_encuesta <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Nacional_dir =</span> <span class="fu">survey_mean</span>(yk_dir)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-61"><a href="postbenchmarking_ic_ali_nc.html#cb11-61" tabindex="-1"></a>    <span class="fu">select</span>(Nacional_dir),</span>
<span id="cb11-62"><a href="postbenchmarking_ic_ali_nc.html#cb11-62" tabindex="-1"></a>  poststrat_df <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(</span>
<span id="cb11-63"><a href="postbenchmarking_ic_ali_nc.html#cb11-63" tabindex="-1"></a>    <span class="at">Nacional_stan_lmer =</span> <span class="fu">sum</span>(n <span class="sc">*</span> yk_stan_lmer) <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb11-64"><a href="postbenchmarking_ic_ali_nc.html#cb11-64" tabindex="-1"></a>    <span class="at">Nacional_bench =</span> <span class="fu">sum</span>(n <span class="sc">*</span> yk_bench) <span class="sc">/</span> <span class="fu">sum</span>(n<span class="sc">*</span>gk_bench),</span>
<span id="cb11-65"><a href="postbenchmarking_ic_ali_nc.html#cb11-65" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span>
<span id="cb11-66"><a href="postbenchmarking_ic_ali_nc.html#cb11-66" tabindex="-1"></a></span>
<span id="cb11-67"><a href="postbenchmarking_ic_ali_nc.html#cb11-67" tabindex="-1"></a></span>
<span id="cb11-68"><a href="postbenchmarking_ic_ali_nc.html#cb11-68" tabindex="-1"></a><span class="do">###########################################</span></span>
<span id="cb11-69"><a href="postbenchmarking_ic_ali_nc.html#cb11-69" tabindex="-1"></a><span class="do">### Validaciones por subgrupo completo  </span><span class="al">###</span></span>
<span id="cb11-70"><a href="postbenchmarking_ic_ali_nc.html#cb11-70" tabindex="-1"></a><span class="do">###########################################</span></span>
<span id="cb11-71"><a href="postbenchmarking_ic_ali_nc.html#cb11-71" tabindex="-1"></a></span>
<span id="cb11-72"><a href="postbenchmarking_ic_ali_nc.html#cb11-72" tabindex="-1"></a>subgrupo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ent&quot;</span>,</span>
<span id="cb11-73"><a href="postbenchmarking_ic_ali_nc.html#cb11-73" tabindex="-1"></a>              <span class="st">&quot;area&quot;</span>,</span>
<span id="cb11-74"><a href="postbenchmarking_ic_ali_nc.html#cb11-74" tabindex="-1"></a>              <span class="st">&quot;sexo&quot;</span>,</span>
<span id="cb11-75"><a href="postbenchmarking_ic_ali_nc.html#cb11-75" tabindex="-1"></a>              <span class="st">&quot;edad&quot;</span>,</span>
<span id="cb11-76"><a href="postbenchmarking_ic_ali_nc.html#cb11-76" tabindex="-1"></a>              <span class="st">&quot;discapacidad&quot;</span>,</span>
<span id="cb11-77"><a href="postbenchmarking_ic_ali_nc.html#cb11-77" tabindex="-1"></a>              <span class="st">&quot;hlengua&quot;</span>,<span class="st">&quot;nivel_edu&quot;</span>)</span>
<span id="cb11-78"><a href="postbenchmarking_ic_ali_nc.html#cb11-78" tabindex="-1"></a></span>
<span id="cb11-79"><a href="postbenchmarking_ic_ali_nc.html#cb11-79" tabindex="-1"></a></span>
<span id="cb11-80"><a href="postbenchmarking_ic_ali_nc.html#cb11-80" tabindex="-1"></a>plot_subgrupo <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb11-81"><a href="postbenchmarking_ic_ali_nc.html#cb11-81" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">setNames</span>(subgrupo, subgrupo),</span>
<span id="cb11-82"><a href="postbenchmarking_ic_ali_nc.html#cb11-82" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">plot_uni_validacion</span>(</span>
<span id="cb11-83"><a href="postbenchmarking_ic_ali_nc.html#cb11-83" tabindex="-1"></a>    <span class="at">sample_diseno =</span> diseno_encuesta,</span>
<span id="cb11-84"><a href="postbenchmarking_ic_ali_nc.html#cb11-84" tabindex="-1"></a>    <span class="at">poststrat =</span> poststrat_df,</span>
<span id="cb11-85"><a href="postbenchmarking_ic_ali_nc.html#cb11-85" tabindex="-1"></a>    <span class="at">by1 =</span> .x</span>
<span id="cb11-86"><a href="postbenchmarking_ic_ali_nc.html#cb11-86" tabindex="-1"></a>  )</span>
<span id="cb11-87"><a href="postbenchmarking_ic_ali_nc.html#cb11-87" tabindex="-1"></a>)</span>
<span id="cb11-88"><a href="postbenchmarking_ic_ali_nc.html#cb11-88" tabindex="-1"></a></span>
<span id="cb11-89"><a href="postbenchmarking_ic_ali_nc.html#cb11-89" tabindex="-1"></a></span>
<span id="cb11-90"><a href="postbenchmarking_ic_ali_nc.html#cb11-90" tabindex="-1"></a>plot_subgrupo<span class="sc">$</span>sexo<span class="sc">$</span>tabla <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n_sample) ) <span class="sc">%&gt;%</span></span>
<span id="cb11-91"><a href="postbenchmarking_ic_ali_nc.html#cb11-91" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ER =</span> <span class="fu">abs</span>((directo <span class="sc">-</span> stan_lmer)<span class="sc">/</span>directo )<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-92"><a href="postbenchmarking_ic_ali_nc.html#cb11-92" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(sexo<span class="sc">:</span>directo_upp,stan_lmer, ER)</span>
<span id="cb11-93"><a href="postbenchmarking_ic_ali_nc.html#cb11-93" tabindex="-1"></a></span>
<span id="cb11-94"><a href="postbenchmarking_ic_ali_nc.html#cb11-94" tabindex="-1"></a>plot_subgrupo<span class="sc">$</span>ent<span class="sc">$</span>gg_plot</span>
<span id="cb11-95"><a href="postbenchmarking_ic_ali_nc.html#cb11-95" tabindex="-1"></a></span>
<span id="cb11-96"><a href="postbenchmarking_ic_ali_nc.html#cb11-96" tabindex="-1"></a>plot_subgrupo<span class="sc">$</span>sexo<span class="sc">$</span>gg_plot <span class="sc">+</span> plot_subgrupo<span class="sc">$</span>nivel_edu<span class="sc">$</span>gg_plot <span class="sc">+</span></span>
<span id="cb11-97"><a href="postbenchmarking_ic_ali_nc.html#cb11-97" tabindex="-1"></a>  plot_subgrupo<span class="sc">$</span>edad<span class="sc">$</span>gg_plot <span class="sc">+</span> plot_subgrupo<span class="sc">$</span>hlengua<span class="sc">$</span>gg_plot <span class="sc">+</span></span>
<span id="cb11-98"><a href="postbenchmarking_ic_ali_nc.html#cb11-98" tabindex="-1"></a>  plot_subgrupo<span class="sc">$</span>area<span class="sc">$</span>gg_plot <span class="sc">+</span> plot_subgrupo<span class="sc">$</span>discapacidad<span class="sc">$</span>gg_plot  </span>
<span id="cb11-99"><a href="postbenchmarking_ic_ali_nc.html#cb11-99" tabindex="-1"></a></span>
<span id="cb11-100"><a href="postbenchmarking_ic_ali_nc.html#cb11-100" tabindex="-1"></a>plot_uni <span class="ot">&lt;-</span> plot_subgrupo<span class="sc">$</span>ent<span class="sc">$</span>gg_plot  <span class="sc">/</span></span>
<span id="cb11-101"><a href="postbenchmarking_ic_ali_nc.html#cb11-101" tabindex="-1"></a>  (</span>
<span id="cb11-102"><a href="postbenchmarking_ic_ali_nc.html#cb11-102" tabindex="-1"></a>    plot_subgrupo<span class="sc">$</span>sexo<span class="sc">$</span>gg_plot <span class="sc">+</span> plot_subgrupo<span class="sc">$</span>nivel_edu<span class="sc">$</span>gg_plot <span class="sc">+</span></span>
<span id="cb11-103"><a href="postbenchmarking_ic_ali_nc.html#cb11-103" tabindex="-1"></a>      plot_subgrupo<span class="sc">$</span>edad<span class="sc">$</span>gg_plot <span class="sc">+</span> plot_subgrupo<span class="sc">$</span>hlengua<span class="sc">$</span>gg_plot <span class="sc">+</span></span>
<span id="cb11-104"><a href="postbenchmarking_ic_ali_nc.html#cb11-104" tabindex="-1"></a>      plot_subgrupo<span class="sc">$</span>area<span class="sc">$</span>gg_plot <span class="sc">+</span> plot_subgrupo<span class="sc">$</span>discapacidad<span class="sc">$</span>gg_plot</span>
<span id="cb11-105"><a href="postbenchmarking_ic_ali_nc.html#cb11-105" tabindex="-1"></a>  )</span>
<span id="cb11-106"><a href="postbenchmarking_ic_ali_nc.html#cb11-106" tabindex="-1"></a></span>
<span id="cb11-107"><a href="postbenchmarking_ic_ali_nc.html#cb11-107" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> plot_uni,</span>
<span id="cb11-108"><a href="postbenchmarking_ic_ali_nc.html#cb11-108" tabindex="-1"></a>       <span class="at">filename =</span> <span class="st">&quot;../output/2020/modelos/plot_uni_ic_ali_nc.jpg&quot;</span>,</span>
<span id="cb11-109"><a href="postbenchmarking_ic_ali_nc.html#cb11-109" tabindex="-1"></a>       <span class="at">scale =</span> <span class="dv">3</span>)</span>
<span id="cb11-110"><a href="postbenchmarking_ic_ali_nc.html#cb11-110" tabindex="-1"></a></span>
<span id="cb11-111"><a href="postbenchmarking_ic_ali_nc.html#cb11-111" tabindex="-1"></a><span class="fu">saveRDS</span>(<span class="at">object =</span>  plot_subgrupo,</span>
<span id="cb11-112"><a href="postbenchmarking_ic_ali_nc.html#cb11-112" tabindex="-1"></a>        <span class="at">file =</span> <span class="st">&quot;../output/2020/modelos/plot_uni_ic_ali_nc.rds&quot;</span>)</span>
<span id="cb11-113"><a href="postbenchmarking_ic_ali_nc.html#cb11-113" tabindex="-1"></a></span>
<span id="cb11-114"><a href="postbenchmarking_ic_ali_nc.html#cb11-114" tabindex="-1"></a><span class="fu">saveRDS</span>(<span class="at">object =</span>  poststrat_df,</span>
<span id="cb11-115"><a href="postbenchmarking_ic_ali_nc.html#cb11-115" tabindex="-1"></a>        <span class="at">file =</span> <span class="st">&quot;../input/2020/muestra_ampliada/poststrat_df_ic_ali_nc.rds&quot;</span>)</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="postbenchmarking_ictpc.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="postbenchmarking_ic_segsoc.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/2023MEXsae/10_PostBenchmarking_ic_ali_nc.qmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.pdf", "Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.epub", "Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

</body>

</html>
