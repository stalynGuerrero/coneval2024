<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>19_Mapas_carencias.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020</title>
  <meta name="description" content="Manual de procesamiento." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="19_Mapas_carencias.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Manual de procesamiento." />
  <meta name="github-repo" content="psirusteam/coneval" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="19_Mapas_carencias.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020" />
  
  <meta name="twitter:description" content="Manual de procesamiento." />
  

<meta name="author" content="Andrés Gutiérrez, Stalyn Guerrero" />


<meta name="date" content="2024-07-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimacion_municipios_carencias_error.html"/>
<link rel="next" href="estimacion_directa_carencias.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Manual de procesamiento.</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#respositodio-de-códigos"><i class="fa fa-check"></i>Respositodio de códigos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-proyecto"><i class="fa fa-check"></i>Estructura del Proyecto</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#librerias-de-r-y-otros-insumos"><i class="fa fa-check"></i>Librerias de <em>R</em> y otros insumos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bases-de-datos-utilizadas"><i class="fa fa-check"></i>Bases de Datos Utilizadas</a></li>
<li class="chapter" data-level="" data-path="indicadores-estimados.html"><a href="indicadores-estimados.html"><i class="fa fa-check"></i>Indicadores estimados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="union_bases.html"><a href="union_bases.html"><i class="fa fa-check"></i>00_union_bases.R</a></li>
<li class="chapter" data-level="" data-path="descarga_satelitales.html"><a href="descarga_satelitales.html"><i class="fa fa-check"></i>01_Descarga_satelitales.R</a></li>
<li class="chapter" data-level="" data-path="union_predictores.html"><a href="union_predictores.html"><i class="fa fa-check"></i>02_Union_predictores.R</a></li>
<li class="chapter" data-level="" data-path="estandarizar_muestra_cuestionario_ampliado.html"><a href="estandarizar_muestra_cuestionario_ampliado.html"><i class="fa fa-check"></i>03_Estandarizar_muestra_cuestionario_ampliado.R</a></li>
<li class="chapter" data-level="" data-path="armonizar_encuesta.html"><a href="armonizar_encuesta.html"><i class="fa fa-check"></i>04_Armonizar_encuesta.R</a></li>
<li class="chapter" data-level="" data-path="validacion_encuestas.html"><a href="validacion_encuestas.html"><i class="fa fa-check"></i>05_Validacion_encuestas.R</a></li>
<li class="chapter" data-level="" data-path="modelo_unidad_ictpc.html"><a href="modelo_unidad_ictpc.html"><i class="fa fa-check"></i>06_Modelo_unidad_ictpc.R</a></li>
<li class="chapter" data-level="" data-path="modelo_unidad_py_ic_ali_nc.html"><a href="modelo_unidad_py_ic_ali_nc.html"><i class="fa fa-check"></i>07_Modelo_unidad_py_ic_ali_nc.R</a></li>
<li class="chapter" data-level="" data-path="modelo_unidad_py_ic_segsoc.html"><a href="modelo_unidad_py_ic_segsoc.html"><i class="fa fa-check"></i>08_Modelo_unidad_py_ic_segsoc</a></li>
<li class="chapter" data-level="" data-path="postbenchmarking_ictpc.html"><a href="postbenchmarking_ictpc.html"><i class="fa fa-check"></i>09_PostBenchmarking_ictpc.R</a></li>
<li class="chapter" data-level="" data-path="postbenchmarking_ic_ali_nc.html"><a href="postbenchmarking_ic_ali_nc.html"><i class="fa fa-check"></i>10_PostBenchmarking_ic_ali_nc.R</a></li>
<li class="chapter" data-level="" data-path="postbenchmarking_ic_segsoc.html"><a href="postbenchmarking_ic_segsoc.html"><i class="fa fa-check"></i>11_PostBenchmarking_ic_segsoc.r</a></li>
<li class="chapter" data-level="" data-path="imputacion_censal.html"><a href="imputacion_censal.html"><i class="fa fa-check"></i>12_Imputacion_censal.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_ent_02.html"><a href="estimacion_ent_02.html"><i class="fa fa-check"></i>13_Estimacion_ent_02.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_municipios_ipm_pobreza.html"><a href="estimacion_municipios_ipm_pobreza.html"><i class="fa fa-check"></i>14_estimacion_municipios_ipm_pobreza.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_municipios_ipm_pobreza_error.html"><a href="estimacion_municipios_ipm_pobreza_error.html"><i class="fa fa-check"></i>15_estimacion_municipios_ipm_pobreza_error.R</a></li>
<li class="chapter" data-level="" data-path="mapas.html"><a href="mapas.html"><i class="fa fa-check"></i>16_Mapas.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_municipios_carencias.html"><a href="estimacion_municipios_carencias.html"><i class="fa fa-check"></i>17_estimacion_municipios_carencias.R</a>
<ul>
<li class="chapter" data-level="0.0.1" data-path="estimacion_municipios_carencias.html"><a href="estimacion_municipios_carencias.html#descripción-general"><i class="fa fa-check"></i><b>0.0.1</b> Descripción General</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="estimacion_municipios_carencias_error.html"><a href="estimacion_municipios_carencias_error.html"><i class="fa fa-check"></i>18_estimacion_municipios_carencias_error.R</a></li>
<li class="chapter" data-level="" data-path="mapas_carencias.html"><a href="mapas_carencias.html"><i class="fa fa-check"></i>19_Mapas_carencias.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_directa_carencias.html"><a href="estimacion_directa_carencias.html"><i class="fa fa-check"></i>20_estimacion_directa_carencias.R</a></li>
<li class="divider"></li>
<li><a Manual de procesamiento. </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mapas_carencias.r" class="section level1 unnumbered hasAnchor">
<h1>19_Mapas_carencias.R<a href="mapas_carencias.html#mapas_carencias.r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Para la ejecución del presente análisis, se debe abrir el archivo <strong>19_Mapas_carencias.R</strong> disponible en la ruta <em>Rcodes/2020/19_Mapas_carencias.R</em>.</p>
<p>El código proporciona un procedimiento para la visualización de estimaciones de carencias y errores de estimación en un formato de mapa utilizando <code>tmap</code> y datos geoespaciales. Primero, limpia el entorno de trabajo en R y establece un límite para el uso de memoria RAM. Luego, carga las librerías necesarias y los datasets relevantes, incluyendo los resultados de estimación de carencia y un shapefile de México que se ajusta para incluir las claves municipales y regionales.</p>
<p>A continuación, define los cortes para la clasificación de los datos en porcentajes y genera mapas temáticos para cada indicador de carencia (como pobreza por ingresos, carencias sociales, etc.). Utiliza el objeto <code>ShapeDAM</code> combinado con <code>ipm_mpios</code> para crear mapas que visualizan estos indicadores con una paleta de colores verde. Cada mapa se guarda como una imagen PNG con alta resolución.</p>
<p>Finalmente, el código realiza un proceso similar para visualizar los errores de estimación asociados a cada indicador. Los cortes para los errores se definen de manera diferente, y se generan mapas temáticos que muestran la magnitud de estos errores. Cada mapa se guarda en formato PNG con especificaciones similares.</p>
<div id="limpieza-del-entorno-y-carga-de-bibliotecas-11" class="section level4 unnumbered hasAnchor">
<h4>Limpieza del Entorno y Carga de Bibliotecas<a href="mapas_carencias.html#limpieza-del-entorno-y-carga-de-bibliotecas-11" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Este fragmento de código realiza una serie de preparativos esenciales antes de ejecutar un análisis de datos. Primero, limpia el entorno de trabajo eliminando todos los objetos existentes en la memoria y fuerza la recolección de basura para liberar espacio en el sistema, asegurando que no queden residuos de ejecuciones anteriores que puedan afectar la ejecución actual. Luego, carga una serie de bibliotecas necesarias para el análisis y la visualización de datos. Entre las bibliotecas cargadas se encuentran <code>dplyr</code> y <code>data.table</code> para la manipulación de datos, <code>haven</code> para la importación de datos, <code>magrittr</code> para el uso de operadores encadenados, <code>stringr</code> para el manejo de cadenas de texto, <code>openxlsx</code> para la manipulación de archivos Excel, y <code>tmap</code> y <code>sf</code> para la creación de mapas y el manejo de datos espaciales. Además, se redefine la función <code>select</code> para asegurarse de que se utilice la versión de <code>dplyr</code>. Finalmente, el código establece un límite de memoria RAM de 250 GB para la ejecución del script, lo cual es crucial para evitar problemas de memoria durante el análisis de grandes volúmenes de datos.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="mapas_carencias.html#cb160-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb160-2"><a href="mapas_carencias.html#cb160-2" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb160-3"><a href="mapas_carencias.html#cb160-3" tabindex="-1"></a></span>
<span id="cb160-4"><a href="mapas_carencias.html#cb160-4" tabindex="-1"></a><span class="do">#################</span></span>
<span id="cb160-5"><a href="mapas_carencias.html#cb160-5" tabindex="-1"></a><span class="do">### Libraries </span><span class="al">###</span></span>
<span id="cb160-6"><a href="mapas_carencias.html#cb160-6" tabindex="-1"></a><span class="do">#################</span></span>
<span id="cb160-7"><a href="mapas_carencias.html#cb160-7" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb160-8"><a href="mapas_carencias.html#cb160-8" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb160-9"><a href="mapas_carencias.html#cb160-9" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb160-10"><a href="mapas_carencias.html#cb160-10" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb160-11"><a href="mapas_carencias.html#cb160-11" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb160-12"><a href="mapas_carencias.html#cb160-12" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb160-13"><a href="mapas_carencias.html#cb160-13" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb160-14"><a href="mapas_carencias.html#cb160-14" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb160-15"><a href="mapas_carencias.html#cb160-15" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb160-16"><a href="mapas_carencias.html#cb160-16" tabindex="-1"></a></span>
<span id="cb160-17"><a href="mapas_carencias.html#cb160-17" tabindex="-1"></a><span class="do">###------------ Definiendo el límite de la memoria RAM a emplear ------------</span><span class="al">###</span></span>
<span id="cb160-18"><a href="mapas_carencias.html#cb160-18" tabindex="-1"></a></span>
<span id="cb160-19"><a href="mapas_carencias.html#cb160-19" tabindex="-1"></a><span class="fu">memory.limit</span>(<span class="dv">250000000</span>)</span></code></pre></div>
<div id="lectura-de-datos-6" class="section level5 unnumbered hasAnchor">
<h5>Lectura de Datos<a href="mapas_carencias.html#lectura-de-datos-6" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Primero, carga un archivo de resultados de pobreza a nivel municipal en formato RDS, utilizando la función <code>readRDS</code>. El archivo cargado, <code>ipm_mpios</code>, contiene los resultados de los indicadores de pobreza a nivel municipal que se han generado previamente.</p>
<p>En segundo lugar, lee un archivo de forma (shapefile) en formato <code>.shp</code> utilizando la función <code>read_sf</code> de la biblioteca <code>sf</code>. Este archivo, ubicado en la carpeta “../shapefile/2020/”, contiene datos espaciales que describen la geografía de México para el año 2020. Una vez cargado el shapefile, el código realiza dos transformaciones en el objeto <code>ShapeDAM</code>: extrae el código de entidad (<code>ent</code>) a partir de los primeros dos dígitos del campo <code>CVEGEO</code>, y elimina la columna <code>CVEGEO</code>, ya que no es necesaria para el análisis posterior.</p>
<p>Finalmente, define un vector <code>cortes</code> que contiene los puntos de corte para la clasificación de datos en intervalos porcentuales (0%, 15%, 30%, 50%, 80%, 100%). Estos cortes serán utilizados para categorizar o visualizar los datos de pobreza en diferentes rangos de intensidad.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="mapas_carencias.html#cb161-1" tabindex="-1"></a>ipm_mpios <span class="ot">&lt;-</span> </span>
<span id="cb161-2"><a href="mapas_carencias.html#cb161-2" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="st">&quot;../output/Entregas/2020/result_mpios_carencia.RDS&quot;</span>)   </span>
<span id="cb161-3"><a href="mapas_carencias.html#cb161-3" tabindex="-1"></a></span>
<span id="cb161-4"><a href="mapas_carencias.html#cb161-4" tabindex="-1"></a>ShapeDAM <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">&quot;../shapefile/2020/MEX_2020.shp&quot;</span>)</span>
<span id="cb161-5"><a href="mapas_carencias.html#cb161-5" tabindex="-1"></a>ShapeDAM <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">cve_mun =</span> CVEGEO ,</span>
<span id="cb161-6"><a href="mapas_carencias.html#cb161-6" tabindex="-1"></a>                     <span class="at">ent =</span> <span class="fu">substr</span>(cve_mun, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb161-7"><a href="mapas_carencias.html#cb161-7" tabindex="-1"></a>                     <span class="at">CVEGEO =</span> <span class="cn">NULL</span>) </span>
<span id="cb161-8"><a href="mapas_carencias.html#cb161-8" tabindex="-1"></a></span>
<span id="cb161-9"><a href="mapas_carencias.html#cb161-9" tabindex="-1"></a>cortes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,  <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">80</span>, <span class="dv">100</span> )<span class="sc">/</span><span class="dv">100</span></span></code></pre></div>
</div>
</div>
<div id="mapas-de-las-carencias-estimadas" class="section level4 unnumbered hasAnchor">
<h4>Mapas de las carencias estimadas<a href="mapas_carencias.html#mapas-de-las-carencias-estimadas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Primero, se crea un objeto <code>P1_mpio_norte</code> utilizando <code>tm_shape</code>, que carga un mapa basado en el shapefile <code>ShapeDAM</code> y une este mapa con los datos de pobreza <code>ipm_mpios</code> a través de la columna <code>cve_mun</code>. Los datos de pobreza son incorporados al mapa utilizando un <code>left_join</code>.</p>
<p>Se define un vector <code>ind</code> que contiene los nombres de los indicadores de pobreza que se desean visualizar en los mapas. Estos indicadores incluyen varias medidas de pobreza y carencias sociales.</p>
<p>Luego, se ejecuta un bucle <code>for</code> que recorre cada indicador en <code>ind</code>. Para cada indicador (<code>yks_ind</code>), se crea un mapa temático (<code>Mapa_I</code>) usando <code>tm_polygons</code>. Este mapa visualiza los datos de pobreza con una paleta de colores verde (<code>palette = "Greens"</code>) y clasifica los datos en intervalos definidos por el vector <code>cortes</code>. El título del mapa incluye el nombre del indicador actual.</p>
<p>La función <code>tm_layout</code> ajusta la presentación del mapa, configurando la leyenda para que sea visible, con un tamaño de texto específico, y colocada en la posición izquierda. La leyenda se presenta en una disposición vertical y con estilos de fuente en negrita.</p>
<p>Finalmente, el mapa se guarda en un archivo PNG utilizando <code>tmap_save</code>, con un tamaño de imagen de 4000x3000 píxeles y una relación de aspecto de 0. El archivo se nombra de acuerdo con el indicador de pobreza actual y se guarda en la carpeta “../output/Entregas/2020/mapas/”.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="mapas_carencias.html#cb162-1" tabindex="-1"></a>P1_mpio_norte <span class="ot">&lt;-</span></span>
<span id="cb162-2"><a href="mapas_carencias.html#cb162-2" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ShapeDAM <span class="sc">%&gt;%</span></span>
<span id="cb162-3"><a href="mapas_carencias.html#cb162-3" tabindex="-1"></a>             <span class="fu">left_join</span>(ipm_mpios,   <span class="at">by =</span> <span class="st">&quot;cve_mun&quot;</span>))</span>
<span id="cb162-4"><a href="mapas_carencias.html#cb162-4" tabindex="-1"></a><span class="fu">names</span>(ipm_mpios)</span>
<span id="cb162-5"><a href="mapas_carencias.html#cb162-5" tabindex="-1"></a></span>
<span id="cb162-6"><a href="mapas_carencias.html#cb162-6" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pobrea_lp&quot;</span>, <span class="st">&quot;pobrea_li&quot;</span>,<span class="st">&quot;tol_ic_1&quot;</span>,<span class="st">&quot;tol_ic_2&quot;</span>,<span class="st">&quot;ic_segsoc&quot;</span>, </span>
<span id="cb162-7"><a href="mapas_carencias.html#cb162-7" tabindex="-1"></a>         <span class="st">&quot;ic_ali_nc&quot;</span>)</span>
<span id="cb162-8"><a href="mapas_carencias.html#cb162-8" tabindex="-1"></a></span>
<span id="cb162-9"><a href="mapas_carencias.html#cb162-9" tabindex="-1"></a></span>
<span id="cb162-10"><a href="mapas_carencias.html#cb162-10" tabindex="-1"></a><span class="cf">for</span>(yks_ind <span class="cf">in</span> ind){</span>
<span id="cb162-11"><a href="mapas_carencias.html#cb162-11" tabindex="-1"></a></span>
<span id="cb162-12"><a href="mapas_carencias.html#cb162-12" tabindex="-1"></a>  Mapa_I <span class="ot">&lt;-</span></span>
<span id="cb162-13"><a href="mapas_carencias.html#cb162-13" tabindex="-1"></a>    P1_mpio_norte <span class="sc">+</span> <span class="fu">tm_polygons</span>(</span>
<span id="cb162-14"><a href="mapas_carencias.html#cb162-14" tabindex="-1"></a>      <span class="at">breaks  =</span> cortes,</span>
<span id="cb162-15"><a href="mapas_carencias.html#cb162-15" tabindex="-1"></a>      yks_ind,</span>
<span id="cb162-16"><a href="mapas_carencias.html#cb162-16" tabindex="-1"></a>      <span class="co"># style = &quot;quantile&quot;,</span></span>
<span id="cb162-17"><a href="mapas_carencias.html#cb162-17" tabindex="-1"></a>      <span class="at">title =</span>  <span class="fu">paste0</span>(<span class="st">&quot;Estimación de la carencia 2020 -&quot;</span>, yks_ind ),</span>
<span id="cb162-18"><a href="mapas_carencias.html#cb162-18" tabindex="-1"></a>      <span class="at">palette =</span> <span class="st">&quot;Greens&quot;</span>,</span>
<span id="cb162-19"><a href="mapas_carencias.html#cb162-19" tabindex="-1"></a>      <span class="at">colorNA =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb162-20"><a href="mapas_carencias.html#cb162-20" tabindex="-1"></a>    ) <span class="sc">+</span> <span class="fu">tm_layout</span>(<span class="at">legend.show =</span> <span class="cn">TRUE</span>,</span>
<span id="cb162-21"><a href="mapas_carencias.html#cb162-21" tabindex="-1"></a>                  <span class="co">#legend.outside = TRUE,</span></span>
<span id="cb162-22"><a href="mapas_carencias.html#cb162-22" tabindex="-1"></a>                  <span class="at">legend.text.size =</span>  <span class="fl">1.5</span>, </span>
<span id="cb162-23"><a href="mapas_carencias.html#cb162-23" tabindex="-1"></a>                  <span class="at">legend.outside.position =</span> <span class="st">&#39;left&#39;</span>,</span>
<span id="cb162-24"><a href="mapas_carencias.html#cb162-24" tabindex="-1"></a>                  <span class="at">legend.hist.width =</span> <span class="dv">1</span>,</span>
<span id="cb162-25"><a href="mapas_carencias.html#cb162-25" tabindex="-1"></a>                  <span class="at">legend.hist.height =</span> <span class="dv">3</span>,</span>
<span id="cb162-26"><a href="mapas_carencias.html#cb162-26" tabindex="-1"></a>                  <span class="at">legend.stack =</span> <span class="st">&#39;vertical&#39;</span>,</span>
<span id="cb162-27"><a href="mapas_carencias.html#cb162-27" tabindex="-1"></a>                  <span class="at">legend.title.fontface =</span> <span class="st">&#39;bold&#39;</span>,</span>
<span id="cb162-28"><a href="mapas_carencias.html#cb162-28" tabindex="-1"></a>                  <span class="at">legend.text.fontface =</span> <span class="st">&#39;bold&#39;</span>) </span>
<span id="cb162-29"><a href="mapas_carencias.html#cb162-29" tabindex="-1"></a>  </span>
<span id="cb162-30"><a href="mapas_carencias.html#cb162-30" tabindex="-1"></a>  </span>
<span id="cb162-31"><a href="mapas_carencias.html#cb162-31" tabindex="-1"></a>  <span class="fu">tmap_save</span>(</span>
<span id="cb162-32"><a href="mapas_carencias.html#cb162-32" tabindex="-1"></a>    Mapa_I,</span>
<span id="cb162-33"><a href="mapas_carencias.html#cb162-33" tabindex="-1"></a>    <span class="at">filename =</span>  <span class="fu">paste0</span>(<span class="st">&quot;../output/Entregas/2020/mapas/carencia_&quot;</span>, yks_ind, <span class="st">&quot;.png&quot;</span>),</span>
<span id="cb162-34"><a href="mapas_carencias.html#cb162-34" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">4000</span>,</span>
<span id="cb162-35"><a href="mapas_carencias.html#cb162-35" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">3000</span>,</span>
<span id="cb162-36"><a href="mapas_carencias.html#cb162-36" tabindex="-1"></a>    <span class="at">asp =</span> <span class="dv">0</span></span>
<span id="cb162-37"><a href="mapas_carencias.html#cb162-37" tabindex="-1"></a>  )</span>
<span id="cb162-38"><a href="mapas_carencias.html#cb162-38" tabindex="-1"></a>  </span>
<span id="cb162-39"><a href="mapas_carencias.html#cb162-39" tabindex="-1"></a>    </span>
<span id="cb162-40"><a href="mapas_carencias.html#cb162-40" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="mapas-del-error-de-la-estimación-de-las-carencias" class="section level4 unnumbered hasAnchor">
<h4>Mapas del error de la estimación de las carencias<a href="mapas_carencias.html#mapas-del-error-de-la-estimación-de-las-carencias" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Primero, se redefine el vector <code>cortes</code> para establecer los intervalos en los que se clasificarán los datos de error de estimación. Los cortes incluyen valores como 0%, 1.5%, 10%, 25%, 50% y 100%.</p>
<p>Luego, se genera un vector <code>ind_ee</code> que contiene los nombres de las variables de error de estimación, obtenidos al anteponer “ee_” a cada indicador de pobreza en <code>ind</code>. Por ejemplo, si <code>ind</code> incluye “pobrea_lp”, entonces <code>ind_ee</code> incluirá “ee_pobrea_lp”.</p>
<p>A continuación, se ejecuta un bucle <code>for</code> que recorre cada indicador de error de estimación en <code>ind_ee</code>. Para cada indicador (<code>yks_ind</code>), se crea un mapa temático (<code>Mapa_I_ee</code>) usando <code>tm_polygons</code>. Este mapa visualiza el error de estimación con la paleta de colores verde (<code>palette = "Greens"</code>) y clasifica los datos en intervalos definidos por el vector <code>cortes</code>. El título del mapa incluye el nombre del indicador de error de estimación actual.</p>
<p>La función <code>tm_layout</code> ajusta la presentación del mapa, configurando la leyenda para que sea visible, con un tamaño de texto específico y ubicada en la posición izquierda. La leyenda se presenta en una disposición vertical y con estilos de fuente en negrita.</p>
<p>Finalmente, el mapa se guarda en un archivo PNG usando <code>tmap_save</code>, con un tamaño de imagen de 4000x3000 píxeles y una relación de aspecto de 0. El archivo se nombra según el indicador de error de estimación actual y se guarda en la carpeta “../output/Entregas/2020/mapas/”.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="mapas_carencias.html#cb163-1" tabindex="-1"></a>cortes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,  <span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>, <span class="dv">25</span>,  <span class="dv">50</span>,  <span class="dv">100</span> )<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb163-2"><a href="mapas_carencias.html#cb163-2" tabindex="-1"></a></span>
<span id="cb163-3"><a href="mapas_carencias.html#cb163-3" tabindex="-1"></a>ind_ee <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;ee_&quot;</span>, ind)</span>
<span id="cb163-4"><a href="mapas_carencias.html#cb163-4" tabindex="-1"></a></span>
<span id="cb163-5"><a href="mapas_carencias.html#cb163-5" tabindex="-1"></a><span class="cf">for</span>(yks_ind <span class="cf">in</span> ind_ee){</span>
<span id="cb163-6"><a href="mapas_carencias.html#cb163-6" tabindex="-1"></a></span>
<span id="cb163-7"><a href="mapas_carencias.html#cb163-7" tabindex="-1"></a>  Mapa_I_ee <span class="ot">&lt;-</span></span>
<span id="cb163-8"><a href="mapas_carencias.html#cb163-8" tabindex="-1"></a>  P1_mpio_norte <span class="sc">+</span> <span class="fu">tm_polygons</span>(</span>
<span id="cb163-9"><a href="mapas_carencias.html#cb163-9" tabindex="-1"></a>    <span class="at">breaks  =</span> cortes,</span>
<span id="cb163-10"><a href="mapas_carencias.html#cb163-10" tabindex="-1"></a>    yks_ind,</span>
<span id="cb163-11"><a href="mapas_carencias.html#cb163-11" tabindex="-1"></a>    <span class="co"># style = &quot;quantile&quot;,</span></span>
<span id="cb163-12"><a href="mapas_carencias.html#cb163-12" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Error de estimación de la carencia 2020 - &quot;</span>, yks_ind),</span>
<span id="cb163-13"><a href="mapas_carencias.html#cb163-13" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">&quot;Greens&quot;</span>,</span>
<span id="cb163-14"><a href="mapas_carencias.html#cb163-14" tabindex="-1"></a>    <span class="at">colorNA =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb163-15"><a href="mapas_carencias.html#cb163-15" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">tm_layout</span>(<span class="at">legend.show =</span> <span class="cn">TRUE</span>,</span>
<span id="cb163-16"><a href="mapas_carencias.html#cb163-16" tabindex="-1"></a>                <span class="co">#legend.outside = TRUE,</span></span>
<span id="cb163-17"><a href="mapas_carencias.html#cb163-17" tabindex="-1"></a>                <span class="at">legend.text.size =</span>  <span class="fl">1.5</span>, </span>
<span id="cb163-18"><a href="mapas_carencias.html#cb163-18" tabindex="-1"></a>                <span class="at">legend.outside.position =</span> <span class="st">&#39;left&#39;</span>,</span>
<span id="cb163-19"><a href="mapas_carencias.html#cb163-19" tabindex="-1"></a>                <span class="at">legend.hist.width =</span> <span class="dv">1</span>,</span>
<span id="cb163-20"><a href="mapas_carencias.html#cb163-20" tabindex="-1"></a>                <span class="at">legend.hist.height =</span> <span class="dv">3</span>,</span>
<span id="cb163-21"><a href="mapas_carencias.html#cb163-21" tabindex="-1"></a>                <span class="at">legend.stack =</span> <span class="st">&#39;vertical&#39;</span>,</span>
<span id="cb163-22"><a href="mapas_carencias.html#cb163-22" tabindex="-1"></a>                <span class="at">legend.title.fontface =</span> <span class="st">&#39;bold&#39;</span>,</span>
<span id="cb163-23"><a href="mapas_carencias.html#cb163-23" tabindex="-1"></a>                <span class="at">legend.text.fontface =</span> <span class="st">&#39;bold&#39;</span>) </span>
<span id="cb163-24"><a href="mapas_carencias.html#cb163-24" tabindex="-1"></a></span>
<span id="cb163-25"><a href="mapas_carencias.html#cb163-25" tabindex="-1"></a></span>
<span id="cb163-26"><a href="mapas_carencias.html#cb163-26" tabindex="-1"></a><span class="fu">tmap_save</span>(</span>
<span id="cb163-27"><a href="mapas_carencias.html#cb163-27" tabindex="-1"></a>  Mapa_I_ee,</span>
<span id="cb163-28"><a href="mapas_carencias.html#cb163-28" tabindex="-1"></a>  <span class="at">filename =</span>  <span class="fu">paste0</span>(<span class="st">&quot;../output/Entregas/2020/mapas/carencia_&quot;</span>, yks_ind, <span class="st">&quot;.png&quot;</span>),</span>
<span id="cb163-29"><a href="mapas_carencias.html#cb163-29" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">4000</span>,</span>
<span id="cb163-30"><a href="mapas_carencias.html#cb163-30" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">3000</span>,</span>
<span id="cb163-31"><a href="mapas_carencias.html#cb163-31" tabindex="-1"></a>  <span class="at">asp =</span> <span class="dv">0</span></span>
<span id="cb163-32"><a href="mapas_carencias.html#cb163-32" tabindex="-1"></a>)</span>
<span id="cb163-33"><a href="mapas_carencias.html#cb163-33" tabindex="-1"></a>}</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estimacion_municipios_carencias_error.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="estimacion_directa_carencias.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/2023MEXsae/19_Mapas_carencias.qmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020.pdf", "Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020.epub", "Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

</body>

</html>
