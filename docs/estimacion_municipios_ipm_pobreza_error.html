<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 16 15_estimacion_municipios_ipm_pobreza_error.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024</title>
  <meta name="description" content="Manual de procesamiento." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 16 15_estimacion_municipios_ipm_pobreza_error.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Manual de procesamiento." />
  <meta name="github-repo" content="psirusteam/coneval" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 16 15_estimacion_municipios_ipm_pobreza_error.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024" />
  
  <meta name="twitter:description" content="Manual de procesamiento." />
  

<meta name="author" content="Andrés Gutiérrez, Stalyn Guerrero" />


<meta name="date" content="2024-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimacion_municipios_ipm_pobreza.html"/>
<link rel="next" href="mapas.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Taller de instalación de capacidades en SAE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="respositodio-de-códigos.html"><a href="respositodio-de-códigos.html"><i class="fa fa-check"></i>Respositodio de códigos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="librerias-de-r-y-otros-insumos.html"><a href="librerias-de-r-y-otros-insumos.html"><i class="fa fa-check"></i>Librerias de <em>R</em> y otros insumos</a>
<ul>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html"><i class="fa fa-check"></i>Librerías Utilizadas</a>
<ul>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#manipulación-y-transformación-de-datos"><i class="fa fa-check"></i>Manipulación y Transformación de Datos</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#lectura-y-escritura-de-datos"><i class="fa fa-check"></i>Lectura y Escritura de Datos</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#análisis-de-datos-de-encuestas"><i class="fa fa-check"></i>Análisis de Datos de Encuestas</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#modelado-y-análisis-estadístico"><i class="fa fa-check"></i>Modelado y Análisis Estadístico</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#visualización-de-datos"><i class="fa fa-check"></i>Visualización de Datos</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#informes-y-reproducibilidad"><i class="fa fa-check"></i>Informes y Reproducibilidad</a></li>
<li class="chapter" data-level="" data-path="librerías-utilizadas.html"><a href="librerías-utilizadas.html#integración-con-otros-lenguajes"><i class="fa fa-check"></i>Integración con Otros Lenguajes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bases-de-datos-utilizadas.html"><a href="bases-de-datos-utilizadas.html"><i class="fa fa-check"></i>Bases de Datos Utilizadas</a></li>
<li class="chapter" data-level="" data-path="estructura-del-proyecto.html"><a href="estructura-del-proyecto.html"><i class="fa fa-check"></i>Estructura del Proyecto</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="union_bases.html"><a href="union_bases.html"><i class="fa fa-check"></i><b>1</b> 00_union_bases.R</a></li>
<li class="chapter" data-level="2" data-path="descarga_satelitales.html"><a href="descarga_satelitales.html"><i class="fa fa-check"></i><b>2</b> 01_Descarga_satelitales.R</a></li>
<li class="chapter" data-level="3" data-path="union_predictores.html"><a href="union_predictores.html"><i class="fa fa-check"></i><b>3</b> 02_Union_predictores.R</a></li>
<li class="chapter" data-level="4" data-path="estandarizar_muestra_cuestionario_ampliado.html"><a href="estandarizar_muestra_cuestionario_ampliado.html"><i class="fa fa-check"></i><b>4</b> 03_Estandarizar_muestra_cuestionario_ampliado.R</a></li>
<li class="chapter" data-level="5" data-path="armonizar_encuesta.html"><a href="armonizar_encuesta.html"><i class="fa fa-check"></i><b>5</b> 04_Armonizar_encuesta.R</a></li>
<li class="chapter" data-level="6" data-path="validacion_encuestas.html"><a href="validacion_encuestas.html"><i class="fa fa-check"></i><b>6</b> 05_Validacion_encuestas.R</a></li>
<li class="chapter" data-level="7" data-path="modelo_unidad_ictpc.html"><a href="modelo_unidad_ictpc.html"><i class="fa fa-check"></i><b>7</b> 06_Modelo_unidad_ictpc.R</a></li>
<li class="chapter" data-level="8" data-path="modelo_unidad_py_ic_ali_nc.html"><a href="modelo_unidad_py_ic_ali_nc.html"><i class="fa fa-check"></i><b>8</b> 07_Modelo_unidad_py_ic_ali_nc.R</a></li>
<li class="chapter" data-level="9" data-path="modelo_unidad_py_ic_segsoc.html"><a href="modelo_unidad_py_ic_segsoc.html"><i class="fa fa-check"></i><b>9</b> 08_Modelo_unidad_py_ic_segsoc</a></li>
<li class="chapter" data-level="10" data-path="postbenchmarking_ictpc.html"><a href="postbenchmarking_ictpc.html"><i class="fa fa-check"></i><b>10</b> 09_PostBenchmarking_ictpc.R</a></li>
<li class="chapter" data-level="11" data-path="postbenchmarking_ic_ali_nc.html"><a href="postbenchmarking_ic_ali_nc.html"><i class="fa fa-check"></i><b>11</b> 10_PostBenchmarking_ic_ali_nc.R</a></li>
<li class="chapter" data-level="12" data-path="postbenchmarking_ic_segsoc.html"><a href="postbenchmarking_ic_segsoc.html"><i class="fa fa-check"></i><b>12</b> 11_PostBenchmarking_ic_segsoc</a></li>
<li class="chapter" data-level="13" data-path="imputacion_censal.html"><a href="imputacion_censal.html"><i class="fa fa-check"></i><b>13</b> 12_Imputacion_censal</a></li>
<li class="chapter" data-level="14" data-path="estimacion_ent_02.html"><a href="estimacion_ent_02.html"><i class="fa fa-check"></i><b>14</b> 13_Estimacion_ent_02.R</a></li>
<li class="chapter" data-level="15" data-path="estimacion_municipios_ipm_pobreza.html"><a href="estimacion_municipios_ipm_pobreza.html"><i class="fa fa-check"></i><b>15</b> 14_estimacion_municipios_ipm_pobreza.R</a></li>
<li class="chapter" data-level="16" data-path="estimacion_municipios_ipm_pobreza_error.html"><a href="estimacion_municipios_ipm_pobreza_error.html"><i class="fa fa-check"></i><b>16</b> 15_estimacion_municipios_ipm_pobreza_error.R</a></li>
<li class="chapter" data-level="17" data-path="mapas.html"><a href="mapas.html"><i class="fa fa-check"></i><b>17</b> 16_Mapas.R</a></li>
<li class="chapter" data-level="18" data-path="estimacion_municipios_carencias.html"><a href="estimacion_municipios_carencias.html"><i class="fa fa-check"></i><b>18</b> 17_estimacion_municipios_carencias.R</a></li>
<li class="divider"></li>
<li><a Taller de instalación de capacidades en SAE </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimacion_municipios_ipm_pobreza_error.r" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Capítulo 16</span> 15_estimacion_municipios_ipm_pobreza_error.R<a href="estimacion_municipios_ipm_pobreza_error.html#estimacion_municipios_ipm_pobreza_error.r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Para la ejecución del presente análisis, se debe abrir el archivo <strong>15_estimacion_municipios_ipm_pobreza_error.R</strong> disponible en la ruta <strong>Rcodes/2020/15_estimacion_municipios_ipm_pobreza_error.R</strong>.</p>
<p>El script comienza con la limpieza del entorno de trabajo y la carga de librerías necesarias, como <code>tidyverse</code> y <code>survey</code>. A continuación, se cargan y preparan los datos de <code>muestra_ampliada</code>, <code>encuesta_enigh</code>, y <code>LB</code>. Se calculan las variables relacionadas con la pobreza multidimensional (IPM) en la encuesta, incluyendo la clasificación en categorías como “I”, “II”, “III”, y “IV”, y se identifican los casos de pobreza moderada y extrema.</p>
<p>Luego, se procesa la información de los resultados de estimación por municipio, que se leen desde archivos generados en iteraciones previas. Se calculan y combinan las estimaciones, varianzas y medias, y se consolidan en un solo conjunto de datos. Estos resultados se guardan en archivos RDS y Excel para su posterior análisis.</p>
<p>Finalmente, se realiza una visualización comparativa de las estimaciones de pobreza multidimensional. Utilizando <code>ggplot2</code>, se crean gráficos que comparan las estimaciones obtenidas de la ENIGH con las de CEPAL para cada entidad, y estos gráficos se exportan en formato PNG. Este paso permite la evaluación visual de la precisión y consistencia de las estimaciones realizadas.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb32-2"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb32-3"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-3" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb32-4"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-4" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb32-5"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-5" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span>
<span id="cb32-6"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-7" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb32-8"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-8" tabindex="-1"></a><span class="co"># Lectura de datos </span></span>
<span id="cb32-9"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-9" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb32-10"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-10" tabindex="-1"></a>muestra_ampliada <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;../output/2020/encuesta_ampliada.rds&quot;</span>)</span>
<span id="cb32-11"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-11" tabindex="-1"></a>encuesta_enigh <span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">&quot;../input/2020/enigh/encuesta_sta.rds&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ingreso =</span> ictpc)</span>
<span id="cb32-13"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-13" tabindex="-1"></a></span>
<span id="cb32-14"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-14" tabindex="-1"></a>LB <span class="ot">&lt;-</span></span>
<span id="cb32-15"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-15" tabindex="-1"></a>  <span class="fu">read.delim</span>(</span>
<span id="cb32-16"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-16" tabindex="-1"></a>    <span class="st">&quot;input/2020/Lineas_Bienestar.csv&quot;</span>,</span>
<span id="cb32-17"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-17" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-18"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-18" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>,</span>
<span id="cb32-19"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-19" tabindex="-1"></a>    <span class="at">dec =</span> <span class="st">&quot;,&quot;</span></span>
<span id="cb32-20"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-20" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">as.character</span>(area))</span>
<span id="cb32-21"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-21" tabindex="-1"></a></span>
<span id="cb32-22"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-22" tabindex="-1"></a></span>
<span id="cb32-23"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-23" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb32-24"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-24" tabindex="-1"></a><span class="co"># IPM en la enigh</span></span>
<span id="cb32-25"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-25" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb32-26"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-26" tabindex="-1"></a>encuesta_enigh <span class="ot">&lt;-</span></span>
<span id="cb32-27"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-27" tabindex="-1"></a>  encuesta_enigh <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(LB)  <span class="sc">%&gt;%</span> </span>
<span id="cb32-28"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-28" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-29"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-29" tabindex="-1"></a>    <span class="at">tol_ic =</span> ic_segsoc <span class="sc">+</span> ic_ali_nc <span class="sc">+</span> ic_asalud <span class="sc">+</span> ic_cv <span class="sc">+</span>  ic_sbv <span class="sc">+</span> ic_rezedu,</span>
<span id="cb32-30"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-30" tabindex="-1"></a>    <span class="at">ipm   =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-31"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-31" tabindex="-1"></a>      <span class="co"># Población en situación de pobreza.</span></span>
<span id="cb32-32"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-32" tabindex="-1"></a>      ingreso <span class="sc">&lt;</span> lp  <span class="sc">&amp;</span>  tol_ic <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;I&quot;</span>,</span>
<span id="cb32-33"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-33" tabindex="-1"></a>      <span class="co"># Población vulnerable por carencias sociales.</span></span>
<span id="cb32-34"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-34" tabindex="-1"></a>      ingreso <span class="sc">&gt;=</span> lp <span class="sc">&amp;</span> tol_ic <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;II&quot;</span>,</span>
<span id="cb32-35"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-35" tabindex="-1"></a>      <span class="co"># Poblacion vulnerable por ingresos.</span></span>
<span id="cb32-36"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-36" tabindex="-1"></a>      ingreso <span class="sc">&lt;=</span> lp <span class="sc">&amp;</span> tol_ic <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;III&quot;</span>,</span>
<span id="cb32-37"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-37" tabindex="-1"></a>      <span class="co"># Población no pobre multidimensional y no vulnerable.</span></span>
<span id="cb32-38"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-38" tabindex="-1"></a>      ingreso <span class="sc">&gt;=</span> lp <span class="sc">&amp;</span> tol_ic <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;IV&quot;</span></span>
<span id="cb32-39"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-39" tabindex="-1"></a>    ),</span>
<span id="cb32-40"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-40" tabindex="-1"></a>    <span class="co"># Población en situación de pobreza moderada.</span></span>
<span id="cb32-41"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-41" tabindex="-1"></a>    <span class="at">pobre_moderada =</span> <span class="fu">ifelse</span>(<span class="fu">c</span>(ingreso <span class="sc">&gt;</span> li <span class="sc">&amp;</span> ingreso <span class="sc">&lt;</span> lp) <span class="sc">&amp;</span></span>
<span id="cb32-42"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-42" tabindex="-1"></a>                              tol_ic <span class="sc">&gt;</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb32-43"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-43" tabindex="-1"></a>    <span class="at">pobre_extrema =</span> <span class="fu">ifelse</span>(ipm <span class="sc">==</span> <span class="st">&quot;I&quot;</span> <span class="sc">&amp;</span> pobre_moderada <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-44"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-44" tabindex="-1"></a>  )</span>
<span id="cb32-45"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-45" tabindex="-1"></a></span>
<span id="cb32-46"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-46" tabindex="-1"></a></span>
<span id="cb32-47"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-47" tabindex="-1"></a>N_mpio <span class="ot">&lt;-</span> muestra_ampliada <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ent,cve_mun) <span class="sc">%&gt;%</span></span>
<span id="cb32-48"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-48" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">N_pers_mpio =</span> <span class="fu">sum</span>(factor))</span>
<span id="cb32-49"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-49" tabindex="-1"></a></span>
<span id="cb32-50"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-50" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb32-51"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-51" tabindex="-1"></a><span class="do">## Lectura de la bases de datos </span></span>
<span id="cb32-52"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-52" tabindex="-1"></a></span>
<span id="cb32-53"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-53" tabindex="-1"></a>list_estiacion <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">&quot;../output/2020/iteraciones/mpio_calib/&quot;</span>, </span>
<span id="cb32-54"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-54" tabindex="-1"></a>                             <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-55"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-55" tabindex="-1"></a></span>
<span id="cb32-56"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-56" tabindex="-1"></a>list_estiacion <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(list_estiacion,</span>
<span id="cb32-57"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-57" tabindex="-1"></a><span class="at">iter =</span> list_estiacion <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(<span class="sc">~</span><span class="fu">list.files</span>(.x) <span class="sc">%&gt;%</span> <span class="fu">length</span>())</span>
<span id="cb32-58"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-58" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(iter <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb32-59"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-59" tabindex="-1"></a></span>
<span id="cb32-60"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-60" tabindex="-1"></a></span>
<span id="cb32-61"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-61" tabindex="-1"></a>resul_ent_ipm <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb32-62"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-62" tabindex="-1"></a></span>
<span id="cb32-63"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-63" tabindex="-1"></a><span class="cf">for</span>(ii_ent <span class="cf">in</span> list_estiacion<span class="sc">$</span>list_estiacion){</span>
<span id="cb32-64"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-64" tabindex="-1"></a>  </span>
<span id="cb32-65"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-65" tabindex="-1"></a>archivos <span class="ot">&lt;-</span> <span class="fu">list.files</span>(ii_ent, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-66"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-66" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">map_df</span>(archivos, <span class="sc">~</span> <span class="fu">readRDS</span>(.x)<span class="sc">$</span>estima_calib)</span>
<span id="cb32-67"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-67" tabindex="-1"></a></span>
<span id="cb32-68"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-68" tabindex="-1"></a>dat_estima <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cve_mun) <span class="sc">%&gt;%</span> </span>
<span id="cb32-69"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-69" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">matches</span>(<span class="st">&quot;var&quot;</span>)), mean) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb32-70"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-70" tabindex="-1"></a></span>
<span id="cb32-71"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-71" tabindex="-1"></a>dat_n <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cve_mun) <span class="sc">%&gt;%</span> <span class="fu">tally</span>()</span>
<span id="cb32-72"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-72" tabindex="-1"></a>dat_B <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cve_mun) <span class="sc">%&gt;%</span> </span>
<span id="cb32-73"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-73" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">matches</span>(<span class="st">&quot;var&quot;</span>)), var) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb32-74"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-74" tabindex="-1"></a></span>
<span id="cb32-75"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-75" tabindex="-1"></a></span>
<span id="cb32-76"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-76" tabindex="-1"></a>dat_Ubar <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cve_mun) <span class="sc">%&gt;%</span> </span>
<span id="cb32-77"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-77" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="fu">matches</span>(<span class="st">&quot;var&quot;</span>)), mean) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb32-78"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-78" tabindex="-1"></a></span>
<span id="cb32-79"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-79" tabindex="-1"></a><span class="fu">names</span>(dat_Ubar) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;_var&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">names</span>(dat_Ubar)) </span>
<span id="cb32-80"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-80" tabindex="-1"></a></span>
<span id="cb32-81"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-81" tabindex="-1"></a>dat_var <span class="ot">&lt;-</span> dat_B <span class="sc">%&gt;%</span> </span>
<span id="cb32-82"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-82" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;Indicador&quot;</span>, <span class="at">value =</span> <span class="st">&quot;B&quot;</span>, <span class="sc">-</span>cve_mun) <span class="sc">%&gt;%</span></span>
<span id="cb32-83"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-83" tabindex="-1"></a>  <span class="fu">inner_join</span>(</span>
<span id="cb32-84"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-84" tabindex="-1"></a>    dat_Ubar <span class="sc">%&gt;%</span> <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;Indicador&quot;</span>, <span class="at">value =</span> <span class="st">&quot;Ubar&quot;</span>, <span class="sc">-</span>cve_mun)</span>
<span id="cb32-85"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-85" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(dat_n)</span>
<span id="cb32-86"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-86" tabindex="-1"></a></span>
<span id="cb32-87"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-87" tabindex="-1"></a>var_est <span class="ot">&lt;-</span>  dat_var <span class="sc">%&gt;%</span> </span>
<span id="cb32-88"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-88" tabindex="-1"></a><span class="fu">transmute</span>(cve_mun, Indicador ,</span>
<span id="cb32-89"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-89" tabindex="-1"></a>          <span class="at">var =</span> Ubar <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n)<span class="sc">*</span>B,</span>
<span id="cb32-90"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-90" tabindex="-1"></a>          <span class="at">ee =</span> <span class="fu">sqrt</span>(var)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-91"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-91" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb32-92"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-92" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb32-93"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-93" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="st">&quot;cve_mun&quot;</span>,</span>
<span id="cb32-94"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-94" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">&quot;Indicador&quot;</span>,</span>
<span id="cb32-95"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-95" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&quot;var&quot;</span>, <span class="st">&quot;ee&quot;</span>),<span class="at">values_fill =</span> <span class="dv">0</span></span>
<span id="cb32-96"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-96" tabindex="-1"></a>  ) </span>
<span id="cb32-97"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-97" tabindex="-1"></a></span>
<span id="cb32-98"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-98" tabindex="-1"></a>dat_var <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb32-99"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-99" tabindex="-1"></a>  <span class="at">data =</span> dat_var,</span>
<span id="cb32-100"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-100" tabindex="-1"></a>  <span class="at">id_cols =</span> <span class="st">&quot;cve_mun&quot;</span>,</span>
<span id="cb32-101"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-101" tabindex="-1"></a>  <span class="at">names_from =</span> <span class="st">&quot;Indicador&quot;</span>,</span>
<span id="cb32-102"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-102" tabindex="-1"></a>  <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;Ubar&quot;</span>),<span class="at">values_fill =</span> <span class="dv">0</span></span>
<span id="cb32-103"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-103" tabindex="-1"></a>) </span>
<span id="cb32-104"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-104" tabindex="-1"></a></span>
<span id="cb32-105"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-105" tabindex="-1"></a>resul_ent_ipm[[ii_ent]] <span class="ot">&lt;-</span> dat_n <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(dat_estima) <span class="sc">%&gt;%</span></span>
<span id="cb32-106"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-106" tabindex="-1"></a>  <span class="fu">inner_join</span>(dat_var) <span class="sc">%&gt;%</span></span>
<span id="cb32-107"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-107" tabindex="-1"></a>  <span class="fu">inner_join</span>(var_est)</span>
<span id="cb32-108"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-108" tabindex="-1"></a></span>
<span id="cb32-109"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-109" tabindex="-1"></a>}</span>
<span id="cb32-110"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-110" tabindex="-1"></a></span>
<span id="cb32-111"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-111" tabindex="-1"></a></span>
<span id="cb32-112"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-112" tabindex="-1"></a><span class="do">######################</span></span>
<span id="cb32-113"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-113" tabindex="-1"></a></span>
<span id="cb32-114"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-114" tabindex="-1"></a>temp <span class="ot">&lt;-</span> resul_ent_ipm <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb32-115"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-115" tabindex="-1"></a></span>
<span id="cb32-116"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-116" tabindex="-1"></a>temp <span class="sc">%&lt;&gt;%</span> <span class="fu">inner_join</span>(N_mpio) <span class="sc">%&gt;%</span> </span>
<span id="cb32-117"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-117" tabindex="-1"></a>  <span class="fu">select</span>(ent, cve_mun, N_pers_mpio, est_ipm_I, </span>
<span id="cb32-118"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-118" tabindex="-1"></a>         est_pob_mod,   est_pob_ext, est_ipm_II<span class="sc">:</span>est_ipm_IV,</span>
<span id="cb32-119"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-119" tabindex="-1"></a>         <span class="at">ee_ipm_I =</span> ee_est_ipm_I,</span>
<span id="cb32-120"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-120" tabindex="-1"></a>         <span class="at">ee_pob_mod =</span> ee_est_pob_mod,</span>
<span id="cb32-121"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-121" tabindex="-1"></a>         <span class="at">ee_pob_ext =</span> ee_est_pob_ext,</span>
<span id="cb32-122"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-122" tabindex="-1"></a>         <span class="at">ee_ipm_II =</span> ee_est_ipm_II,</span>
<span id="cb32-123"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-123" tabindex="-1"></a>         <span class="at">ee_ipm_III =</span> ee_est_ipm_III,</span>
<span id="cb32-124"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-124" tabindex="-1"></a>         <span class="at">ee_ipm_IV =</span> ee_est_ipm_IV)</span>
<span id="cb32-125"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-125" tabindex="-1"></a></span>
<span id="cb32-126"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-126" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb32-127"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-127" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;../output/Entregas/2020/result_mpios.RDS&quot;</span>)</span>
<span id="cb32-128"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-128" tabindex="-1"></a></span>
<span id="cb32-129"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-129" tabindex="-1"></a></span>
<span id="cb32-130"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-130" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(temp,</span>
<span id="cb32-131"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-131" tabindex="-1"></a>                     <span class="fu">paste0</span>(</span>
<span id="cb32-132"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-132" tabindex="-1"></a>                       <span class="st">&quot;../output/Entregas/2020/estimacion_numicipal_&quot;</span>,</span>
<span id="cb32-133"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-133" tabindex="-1"></a>                       <span class="fu">Sys.Date</span>() ,</span>
<span id="cb32-134"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-134" tabindex="-1"></a>                       <span class="st">&quot;.xlsx&quot;</span></span>
<span id="cb32-135"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-135" tabindex="-1"></a>                     ))</span>
<span id="cb32-136"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-136" tabindex="-1"></a></span>
<span id="cb32-137"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-137" tabindex="-1"></a>temp2 <span class="ot">&lt;-</span> temp <span class="sc">%&gt;%</span></span>
<span id="cb32-138"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-138" tabindex="-1"></a>  <span class="fu">select</span>(ent, est_ipm_I<span class="sc">:</span>est_ipm_IV, N_pers_mpio) <span class="sc">%&gt;%</span></span>
<span id="cb32-139"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-139" tabindex="-1"></a>  <span class="fu">group_by</span>(ent) <span class="sc">%&gt;%</span></span>
<span id="cb32-140"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-140" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;est_&quot;</span>),</span>
<span id="cb32-141"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-141" tabindex="-1"></a>                   <span class="sc">~</span> <span class="fu">sum</span>(.x <span class="sc">*</span> N_pers_mpio) <span class="sc">/</span> <span class="fu">sum</span>(N_pers_mpio)))</span>
<span id="cb32-142"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-142" tabindex="-1"></a></span>
<span id="cb32-143"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-143" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(temp2,</span>
<span id="cb32-144"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-144" tabindex="-1"></a>                     <span class="fu">paste0</span>(</span>
<span id="cb32-145"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-145" tabindex="-1"></a>                       <span class="st">&quot;../output/Entregas/2020/estimacion_estado_&quot;</span>,</span>
<span id="cb32-146"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-146" tabindex="-1"></a>                       <span class="fu">Sys.Date</span>() ,</span>
<span id="cb32-147"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-147" tabindex="-1"></a>                       <span class="st">&quot;.xlsx&quot;</span></span>
<span id="cb32-148"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-148" tabindex="-1"></a>                     ))</span>
<span id="cb32-149"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-149" tabindex="-1"></a></span>
<span id="cb32-150"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-150" tabindex="-1"></a></span>
<span id="cb32-151"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-151" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb32-152"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-152" tabindex="-1"></a><span class="co"># Plot uni</span></span>
<span id="cb32-153"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-153" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb32-154"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-154" tabindex="-1"></a>diseno <span class="ot">&lt;-</span> encuesta_enigh <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-155"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-155" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb32-156"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-156" tabindex="-1"></a>    <span class="at">ids =</span> upm,</span>
<span id="cb32-157"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-157" tabindex="-1"></a>    <span class="at">weights =</span> fep,</span>
<span id="cb32-158"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-158" tabindex="-1"></a>    <span class="at">nest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-159"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-159" tabindex="-1"></a>    <span class="at">strata =</span> estrato</span>
<span id="cb32-160"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-160" tabindex="-1"></a>  )</span>
<span id="cb32-161"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-161" tabindex="-1"></a></span>
<span id="cb32-162"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-162" tabindex="-1"></a>estimad_dir <span class="ot">&lt;-</span> diseno <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ent,ipm) <span class="sc">%&gt;%</span> </span>
<span id="cb32-163"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-163" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">direct =</span> <span class="fu">survey_mean</span>(<span class="at">vartype =</span> <span class="st">&quot;ci&quot;</span> ))</span>
<span id="cb32-164"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-164" tabindex="-1"></a></span>
<span id="cb32-165"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-165" tabindex="-1"></a>estimad_dir_ipm <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb32-166"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-166" tabindex="-1"></a>  <span class="at">data =</span> estimad_dir,</span>
<span id="cb32-167"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-167" tabindex="-1"></a>  <span class="at">id_cols =</span> <span class="st">&quot;ent&quot;</span>,</span>
<span id="cb32-168"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-168" tabindex="-1"></a>  <span class="at">names_from =</span> <span class="st">&quot;ipm&quot;</span>,</span>
<span id="cb32-169"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-169" tabindex="-1"></a>  <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&quot;direct&quot;</span>, <span class="st">&quot;direct_low&quot;</span>,<span class="st">&quot;direct_upp&quot;</span>)</span>
<span id="cb32-170"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-170" tabindex="-1"></a>) </span>
<span id="cb32-171"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-171" tabindex="-1"></a></span>
<span id="cb32-172"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-172" tabindex="-1"></a>estimad_dir <span class="ot">&lt;-</span> diseno <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ent) <span class="sc">%&gt;%</span> </span>
<span id="cb32-173"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-173" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">direct_mod =</span> <span class="fu">survey_mean</span>(pobre_moderada, <span class="at">vartype =</span> <span class="st">&quot;ci&quot;</span> ),</span>
<span id="cb32-174"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-174" tabindex="-1"></a>            <span class="at">direct_ext =</span> <span class="fu">survey_mean</span>(pobre_extrema, <span class="at">vartype =</span> <span class="st">&quot;ci&quot;</span> ))</span>
<span id="cb32-175"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-175" tabindex="-1"></a></span>
<span id="cb32-176"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-176" tabindex="-1"></a>estimad_dir <span class="sc">%&lt;&gt;%</span> <span class="fu">inner_join</span>(estimad_dir_ipm)</span>
<span id="cb32-177"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-177" tabindex="-1"></a></span>
<span id="cb32-178"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-178" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;I&quot;</span>, <span class="st">&quot;II&quot;</span>, <span class="st">&quot;III&quot;</span>, <span class="st">&quot;IV&quot;</span>, <span class="st">&quot;mod&quot;</span>, <span class="st">&quot;ext&quot;</span>)</span>
<span id="cb32-179"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-179" tabindex="-1"></a>ii_ipm  <span class="ot">=</span><span class="dv">1</span></span>
<span id="cb32-180"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-180" tabindex="-1"></a><span class="cf">for</span> (ii_ipm <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb32-181"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-181" tabindex="-1"></a>    ii_ipm <span class="ot">&lt;-</span> ind[ii_ipm]</span>
<span id="cb32-182"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-182" tabindex="-1"></a>    paso <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(_|</span><span class="sc">\\</span><span class="st">b)&quot;</span>, ii_ipm,<span class="st">&quot;(_|</span><span class="sc">\\</span><span class="st">b)&quot;</span> )</span>
<span id="cb32-183"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-183" tabindex="-1"></a>   dat_plot <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(estimad_dir, temp2) <span class="sc">%&gt;%</span> </span>
<span id="cb32-184"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-184" tabindex="-1"></a>    <span class="fu">select</span>(ent, <span class="fu">matches</span>(paso))  </span>
<span id="cb32-185"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-185" tabindex="-1"></a>  </span>
<span id="cb32-186"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-186" tabindex="-1"></a>   dat_lim  <span class="ot">&lt;-</span> dat_plot <span class="sc">%&gt;%</span> <span class="fu">select</span>(ent, <span class="fu">matches</span>(<span class="st">&quot;upp|low&quot;</span>))</span>
<span id="cb32-187"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-187" tabindex="-1"></a>   </span>
<span id="cb32-188"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-188" tabindex="-1"></a>   <span class="fu">names</span>(dat_lim) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ent&quot;</span>,<span class="st">&quot;Lim_Inf&quot;</span>, <span class="st">&quot;Lim_Sup&quot;</span>)</span>
<span id="cb32-189"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-189" tabindex="-1"></a>   </span>
<span id="cb32-190"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-190" tabindex="-1"></a>   dat_plot <span class="sc">%&lt;&gt;%</span> <span class="fu">select</span>( <span class="sc">-</span><span class="fu">matches</span>(<span class="st">&quot;upp|low&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-191"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-191" tabindex="-1"></a>     <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;Origen&quot;</span>, <span class="at">value =</span> <span class="st">&quot;Prop&quot;</span>, <span class="sc">-</span>ent) <span class="sc">%&gt;%</span> </span>
<span id="cb32-192"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-192" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">Origen =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">&quot;direct&quot;</span>, <span class="at">x =</span> Origen), </span>
<span id="cb32-193"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-193" tabindex="-1"></a>                            <span class="st">&quot;ENIGH&quot;</span>, <span class="st">&quot;Estimación CEPAL&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-194"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-194" tabindex="-1"></a>     <span class="fu">inner_join</span>(dat_lim)</span>
<span id="cb32-195"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-195" tabindex="-1"></a>   </span>
<span id="cb32-196"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-196" tabindex="-1"></a>  </span>
<span id="cb32-197"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-197" tabindex="-1"></a>   gg_plot <span class="ot">&lt;-</span></span>
<span id="cb32-198"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-198" tabindex="-1"></a>     <span class="fu">ggplot</span>(<span class="at">data =</span> dat_plot, <span class="fu">aes</span>(<span class="at">x =</span> ent, <span class="at">y =</span> Prop, <span class="at">color =</span> Origen)) <span class="sc">+</span></span>
<span id="cb32-199"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-199" tabindex="-1"></a>     <span class="fu">labs</span>(</span>
<span id="cb32-200"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-200" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb32-201"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-201" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Estimación&quot;</span>,</span>
<span id="cb32-202"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-202" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb32-203"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-203" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Estimación de la pobreza multidimensional 2020 - Tipo &quot;</span>, ii_ipm )</span>
<span id="cb32-204"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-204" tabindex="-1"></a>     )<span class="sc">+</span> <span class="fu">theme_bw</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb32-205"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-205" tabindex="-1"></a>     <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb32-206"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-206" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb32-207"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-207" tabindex="-1"></a>           <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb32-208"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-208" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">100</span>))</span>
<span id="cb32-209"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-209" tabindex="-1"></a>   </span>
<span id="cb32-210"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-210" tabindex="-1"></a>   gg_plot <span class="ot">&lt;-</span>  gg_plot <span class="sc">+</span></span>
<span id="cb32-211"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-211" tabindex="-1"></a>     <span class="fu">geom_errorbar</span>(<span class="at">data =</span> dat_plot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Origen   <span class="sc">==</span> <span class="st">&quot;ENIGH&quot;</span>),</span>
<span id="cb32-212"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-212" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">ymin =</span> Lim_Inf  , </span>
<span id="cb32-213"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-213" tabindex="-1"></a>                       <span class="at">ymax =</span> Lim_Sup, <span class="at">x =</span> ent),</span>
<span id="cb32-214"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-214" tabindex="-1"></a>                   <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-215"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-215" tabindex="-1"></a>     <span class="fu">scale_color_manual</span>(</span>
<span id="cb32-216"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-216" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;ENIGH&quot;</span>, <span class="st">&quot;Estimación CEPAL&quot;</span>),</span>
<span id="cb32-217"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-217" tabindex="-1"></a>       <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue3&quot;</span>)</span>
<span id="cb32-218"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-218" tabindex="-1"></a>     ) <span class="sc">+</span></span>
<span id="cb32-219"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-219" tabindex="-1"></a>     <span class="fu">theme</span>(</span>
<span id="cb32-220"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-220" tabindex="-1"></a>       <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb32-221"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-221" tabindex="-1"></a>       <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb32-222"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-222" tabindex="-1"></a>       <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb32-223"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-223" tabindex="-1"></a>       <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb32-224"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-224" tabindex="-1"></a>         <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb32-225"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-225" tabindex="-1"></a>         <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb32-226"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-226" tabindex="-1"></a>         <span class="at">vjust =</span> <span class="fl">0.3</span></span>
<span id="cb32-227"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-227" tabindex="-1"></a>       ),</span>
<span id="cb32-228"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-228" tabindex="-1"></a>       <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb32-229"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-229" tabindex="-1"></a>       <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)</span>
<span id="cb32-230"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-230" tabindex="-1"></a>     )</span>
<span id="cb32-231"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-231" tabindex="-1"></a>   </span>
<span id="cb32-232"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-232" tabindex="-1"></a>   <span class="fu">ggsave</span>(<span class="at">plot =</span> gg_plot, <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">9</span>,</span>
<span id="cb32-233"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-233" tabindex="-1"></a>          <span class="at">filename =</span> <span class="fu">paste0</span>(<span class="st">&quot;../output/Entregas/2020/plot_uni/ipm_&quot;</span>, ii_ipm, <span class="st">&quot;.png&quot;</span>))</span>
<span id="cb32-234"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-234" tabindex="-1"></a>   </span>
<span id="cb32-235"><a href="estimacion_municipios_ipm_pobreza_error.html#cb32-235" tabindex="-1"></a>}</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="estimacion_municipios_ipm_pobreza.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mapas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/2023MEXsae/15_estimacion_municipios_ipm_pobreza_error.qmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.pdf", "Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.epub", "Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

</body>

</html>
