<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15_estimacion_municipios_ipm_pobreza_error.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020</title>
  <meta name="description" content="Manual de procesamiento." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="15_estimacion_municipios_ipm_pobreza_error.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Manual de procesamiento." />
  <meta name="github-repo" content="psirusteam/coneval" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15_estimacion_municipios_ipm_pobreza_error.R | Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020" />
  
  <meta name="twitter:description" content="Manual de procesamiento." />
  

<meta name="author" content="Andrés Gutiérrez, Stalyn Guerrero" />


<meta name="date" content="2024-07-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimacion_municipios_ipm_pobreza.html"/>
<link rel="next" href="mapas.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Manual de procesamiento.</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#respositodio-de-códigos"><i class="fa fa-check"></i>Respositodio de códigos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-proyecto"><i class="fa fa-check"></i>Estructura del Proyecto</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#librerias-de-r-y-otros-insumos"><i class="fa fa-check"></i>Librerias de <em>R</em> y otros insumos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bases-de-datos-utilizadas"><i class="fa fa-check"></i>Bases de Datos Utilizadas</a></li>
<li class="chapter" data-level="" data-path="indicadores-estimados.html"><a href="indicadores-estimados.html"><i class="fa fa-check"></i>Indicadores estimados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="union_bases.html"><a href="union_bases.html"><i class="fa fa-check"></i>00_union_bases.R</a></li>
<li class="chapter" data-level="" data-path="descarga_satelitales.html"><a href="descarga_satelitales.html"><i class="fa fa-check"></i>01_Descarga_satelitales.R</a></li>
<li class="chapter" data-level="" data-path="union_predictores.html"><a href="union_predictores.html"><i class="fa fa-check"></i>02_Union_predictores.R</a></li>
<li class="chapter" data-level="" data-path="estandarizar_muestra_cuestionario_ampliado.html"><a href="estandarizar_muestra_cuestionario_ampliado.html"><i class="fa fa-check"></i>03_Estandarizar_muestra_cuestionario_ampliado.R</a></li>
<li class="chapter" data-level="" data-path="armonizar_encuesta.html"><a href="armonizar_encuesta.html"><i class="fa fa-check"></i>04_Armonizar_encuesta.R</a></li>
<li class="chapter" data-level="" data-path="validacion_encuestas.html"><a href="validacion_encuestas.html"><i class="fa fa-check"></i>05_Validacion_encuestas.R</a></li>
<li class="chapter" data-level="" data-path="modelo_unidad_ictpc.html"><a href="modelo_unidad_ictpc.html"><i class="fa fa-check"></i>06_Modelo_unidad_ictpc.R</a></li>
<li class="chapter" data-level="" data-path="modelo_unidad_py_ic_ali_nc.html"><a href="modelo_unidad_py_ic_ali_nc.html"><i class="fa fa-check"></i>07_Modelo_unidad_py_ic_ali_nc.R</a></li>
<li class="chapter" data-level="" data-path="modelo_unidad_py_ic_segsoc.html"><a href="modelo_unidad_py_ic_segsoc.html"><i class="fa fa-check"></i>08_Modelo_unidad_py_ic_segsoc</a></li>
<li class="chapter" data-level="" data-path="postbenchmarking_ictpc.html"><a href="postbenchmarking_ictpc.html"><i class="fa fa-check"></i>09_PostBenchmarking_ictpc.R</a></li>
<li class="chapter" data-level="" data-path="postbenchmarking_ic_ali_nc.html"><a href="postbenchmarking_ic_ali_nc.html"><i class="fa fa-check"></i>10_PostBenchmarking_ic_ali_nc.R</a></li>
<li class="chapter" data-level="" data-path="postbenchmarking_ic_segsoc.html"><a href="postbenchmarking_ic_segsoc.html"><i class="fa fa-check"></i>11_PostBenchmarking_ic_segsoc.r</a></li>
<li class="chapter" data-level="" data-path="imputacion_censal.html"><a href="imputacion_censal.html"><i class="fa fa-check"></i>12_Imputacion_censal.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_ent_02.html"><a href="estimacion_ent_02.html"><i class="fa fa-check"></i>13_Estimacion_ent_02.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_municipios_ipm_pobreza.html"><a href="estimacion_municipios_ipm_pobreza.html"><i class="fa fa-check"></i>14_estimacion_municipios_ipm_pobreza.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_municipios_ipm_pobreza_error.html"><a href="estimacion_municipios_ipm_pobreza_error.html"><i class="fa fa-check"></i>15_estimacion_municipios_ipm_pobreza_error.R</a></li>
<li class="chapter" data-level="" data-path="mapas.html"><a href="mapas.html"><i class="fa fa-check"></i>16_Mapas.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_municipios_carencias.html"><a href="estimacion_municipios_carencias.html"><i class="fa fa-check"></i>17_estimacion_municipios_carencias.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_municipios_carencias_error.html"><a href="estimacion_municipios_carencias_error.html"><i class="fa fa-check"></i>18_estimacion_municipios_carencias_error.R</a></li>
<li class="chapter" data-level="" data-path="mapas_carencias.html"><a href="mapas_carencias.html"><i class="fa fa-check"></i>19_Mapas_carencias.R</a></li>
<li class="chapter" data-level="" data-path="estimacion_directa_carencias.html"><a href="estimacion_directa_carencias.html"><i class="fa fa-check"></i>20_estimacion_directa_carencias.R</a></li>
<li class="divider"></li>
<li><a Manual de procesamiento. </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimacion_municipios_ipm_pobreza_error.r" class="section level1 unnumbered hasAnchor">
<h1>15_estimacion_municipios_ipm_pobreza_error.R<a href="estimacion_municipios_ipm_pobreza_error.html#estimacion_municipios_ipm_pobreza_error.r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Para la ejecución del presente análisis, se debe abrir el archivo <strong>15_estimacion_municipios_ipm_pobreza_error.R</strong> disponible en la ruta <strong>Rcodes/2020/15_estimacion_municipios_ipm_pobreza_error.R</strong>.</p>
<p>El script comienza con la limpieza del entorno de trabajo y la carga de librerías necesarias, como <code>tidyverse</code> y <code>survey</code>. A continuación, se cargan y preparan los datos de <code>muestra_ampliada</code>, <code>encuesta_enigh</code>, y <code>LB</code>. Se calculan las variables relacionadas con la pobreza multidimensional (IPM) en la encuesta, incluyendo la clasificación en categorías como “I”, “II”, “III”, y “IV”, y se identifican los casos de pobreza moderada y extrema.</p>
<p>Luego, se procesa la información de los resultados de estimación por municipio, que se leen desde archivos generados en iteraciones previas. Se calculan y combinan las estimaciones, varianzas y medias, y se consolidan en un solo conjunto de datos. Estos resultados se guardan en archivos RDS y Excel para su posterior análisis.</p>
<p>Finalmente, se realiza una visualización comparativa de las estimaciones de pobreza multidimensional. Utilizando <code>ggplot2</code>, se crean gráficos que comparan las estimaciones obtenidas de la ENIGH con las de CEPAL para cada estado, y estos gráficos se exportan en formato PNG. Este paso permite la evaluación visual de la precisión y consistencia de las estimaciones realizadas.</p>
<p>El código que compartiste está orientado a procesar y analizar datos de una encuesta para calcular y comparar las estimaciones de pobreza y el Índice de Pobreza Multidimensional (IPM). A continuación, te proporciono un desglose de las principales secciones y acciones del código:</p>
<div id="preparación-del-entorno" class="section level4 unnumbered hasAnchor">
<h4>Preparación del Entorno<a href="estimacion_municipios_ipm_pobreza_error.html#preparación-del-entorno" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Limpia el entorno y carga las bibliotecas necesarias para el análisis.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="estimacion_municipios_ipm_pobreza_error.html#cb113-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb113-2"><a href="estimacion_municipios_ipm_pobreza_error.html#cb113-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb113-3"><a href="estimacion_municipios_ipm_pobreza_error.html#cb113-3" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb113-4"><a href="estimacion_municipios_ipm_pobreza_error.html#cb113-4" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb113-5"><a href="estimacion_municipios_ipm_pobreza_error.html#cb113-5" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span></code></pre></div>
</div>
<div id="lectura-de-datos-3" class="section level4 unnumbered hasAnchor">
<h4>Lectura de Datos<a href="estimacion_municipios_ipm_pobreza_error.html#lectura-de-datos-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Carga y prepara los datos necesarios: <code>muestra_ampliada</code>, <code>encuesta_enigh</code>, y <code>LB</code>.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="estimacion_municipios_ipm_pobreza_error.html#cb114-1" tabindex="-1"></a>muestra_ampliada <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;../output/2020/encuesta_ampliada.rds&quot;</span>)</span>
<span id="cb114-2"><a href="estimacion_municipios_ipm_pobreza_error.html#cb114-2" tabindex="-1"></a>encuesta_enigh <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;../input/2020/enigh/encuesta_sta.rds&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="estimacion_municipios_ipm_pobreza_error.html#cb114-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ingreso =</span> ictpc)</span>
<span id="cb114-4"><a href="estimacion_municipios_ipm_pobreza_error.html#cb114-4" tabindex="-1"></a></span>
<span id="cb114-5"><a href="estimacion_municipios_ipm_pobreza_error.html#cb114-5" tabindex="-1"></a>LB <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(</span>
<span id="cb114-6"><a href="estimacion_municipios_ipm_pobreza_error.html#cb114-6" tabindex="-1"></a>    <span class="st">&quot;input/2020/Lineas_Bienestar.csv&quot;</span>,</span>
<span id="cb114-7"><a href="estimacion_municipios_ipm_pobreza_error.html#cb114-7" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb114-8"><a href="estimacion_municipios_ipm_pobreza_error.html#cb114-8" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>,</span>
<span id="cb114-9"><a href="estimacion_municipios_ipm_pobreza_error.html#cb114-9" tabindex="-1"></a>    <span class="at">dec =</span> <span class="st">&quot;,&quot;</span></span>
<span id="cb114-10"><a href="estimacion_municipios_ipm_pobreza_error.html#cb114-10" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">as.character</span>(area))</span></code></pre></div>
</div>
<div id="cálculo-del-ipm-en-la-encuesta-1" class="section level4 unnumbered hasAnchor">
<h4>Cálculo del IPM en la Encuesta<a href="estimacion_municipios_ipm_pobreza_error.html#cálculo-del-ipm-en-la-encuesta-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Calcula el IPM y las variables asociadas en <code>encuesta_enigh</code>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-1" tabindex="-1"></a>encuesta_enigh <span class="ot">&lt;-</span></span>
<span id="cb115-2"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-2" tabindex="-1"></a>  encuesta_enigh <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(LB)  <span class="sc">%&gt;%</span> </span>
<span id="cb115-3"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb115-4"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-4" tabindex="-1"></a>    <span class="at">tol_ic =</span> ic_segsoc <span class="sc">+</span> ic_ali_nc <span class="sc">+</span> ic_asalud <span class="sc">+</span> ic_cv <span class="sc">+</span>  ic_sbv <span class="sc">+</span> ic_rezedu,</span>
<span id="cb115-5"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-5" tabindex="-1"></a>    <span class="at">ipm   =</span> <span class="fu">case_when</span>(</span>
<span id="cb115-6"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-6" tabindex="-1"></a>      ingreso <span class="sc">&lt;</span> lp  <span class="sc">&amp;</span>  tol_ic <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;I&quot;</span>,</span>
<span id="cb115-7"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-7" tabindex="-1"></a>      ingreso <span class="sc">&gt;=</span> lp <span class="sc">&amp;</span> tol_ic <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;II&quot;</span>,</span>
<span id="cb115-8"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-8" tabindex="-1"></a>      ingreso <span class="sc">&lt;=</span> lp <span class="sc">&amp;</span> tol_ic <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;III&quot;</span>,</span>
<span id="cb115-9"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-9" tabindex="-1"></a>      ingreso <span class="sc">&gt;=</span> lp <span class="sc">&amp;</span> tol_ic <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;IV&quot;</span></span>
<span id="cb115-10"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-10" tabindex="-1"></a>    ),</span>
<span id="cb115-11"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-11" tabindex="-1"></a>    <span class="at">pobre_moderada =</span> <span class="fu">ifelse</span>(<span class="fu">c</span>(ingreso <span class="sc">&gt;</span> li <span class="sc">&amp;</span> ingreso <span class="sc">&lt;</span> lp) <span class="sc">&amp;</span></span>
<span id="cb115-12"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-12" tabindex="-1"></a>                              tol_ic <span class="sc">&gt;</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb115-13"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-13" tabindex="-1"></a>    <span class="at">pobre_extrema =</span> <span class="fu">ifelse</span>(ipm <span class="sc">==</span> <span class="st">&quot;I&quot;</span> <span class="sc">&amp;</span> pobre_moderada <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb115-14"><a href="estimacion_municipios_ipm_pobreza_error.html#cb115-14" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="resumen-de-datos-por-municipio" class="section level4 unnumbered hasAnchor">
<h4>Resumen de Datos por Municipio<a href="estimacion_municipios_ipm_pobreza_error.html#resumen-de-datos-por-municipio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suma el número de personas por municipio en <code>muestra_ampliada</code>.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="estimacion_municipios_ipm_pobreza_error.html#cb116-1" tabindex="-1"></a>N_mpio <span class="ot">&lt;-</span> muestra_ampliada <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ent, cve_mun) <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="estimacion_municipios_ipm_pobreza_error.html#cb116-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">N_pers_mpio =</span> <span class="fu">sum</span>(factor))</span></code></pre></div>
</div>
<div id="lectura-de-archivos-de-iteraciones-y-cálculo-de-estadísticas" class="section level4 unnumbered hasAnchor">
<h4>Lectura de Archivos de Iteraciones y Cálculo de Estadísticas<a href="estimacion_municipios_ipm_pobreza_error.html#lectura-de-archivos-de-iteraciones-y-cálculo-de-estadísticas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Lee los archivos generados en iteraciones y filtra aquellos con resultados.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="estimacion_municipios_ipm_pobreza_error.html#cb117-1" tabindex="-1"></a>list_estiacion <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">&quot;../output/2020/iteraciones/mpio_calib/&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb117-2"><a href="estimacion_municipios_ipm_pobreza_error.html#cb117-2" tabindex="-1"></a></span>
<span id="cb117-3"><a href="estimacion_municipios_ipm_pobreza_error.html#cb117-3" tabindex="-1"></a>list_estiacion <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(list_estiacion,</span>
<span id="cb117-4"><a href="estimacion_municipios_ipm_pobreza_error.html#cb117-4" tabindex="-1"></a><span class="at">iter =</span> list_estiacion <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(<span class="sc">~</span><span class="fu">list.files</span>(.x) <span class="sc">%&gt;%</span> <span class="fu">length</span>())</span>
<span id="cb117-5"><a href="estimacion_municipios_ipm_pobreza_error.html#cb117-5" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(iter <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
</div>
<div id="proceso-iterativo-para-cada-estado" class="section level4 unnumbered hasAnchor">
<h4>Proceso Iterativo para Cada estado<a href="estimacion_municipios_ipm_pobreza_error.html#proceso-iterativo-para-cada-estado" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Para cada estado, se calculan las estimaciones promedio, la varianza, y otros indicadores. Los resultados se guardan en una lista.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-1" tabindex="-1"></a>resul_ent_ipm <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb118-2"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-2" tabindex="-1"></a></span>
<span id="cb118-3"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-3" tabindex="-1"></a><span class="cf">for</span>(ii_ent <span class="cf">in</span> list_estiacion<span class="sc">$</span>list_estiacion){</span>
<span id="cb118-4"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-4" tabindex="-1"></a>  </span>
<span id="cb118-5"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-5" tabindex="-1"></a>  archivos <span class="ot">&lt;-</span> <span class="fu">list.files</span>(ii_ent, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb118-6"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-6" tabindex="-1"></a>  datos <span class="ot">&lt;-</span> <span class="fu">map_df</span>(archivos, <span class="sc">~</span> <span class="fu">readRDS</span>(.x)<span class="sc">$</span>estima_calib)</span>
<span id="cb118-7"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-7" tabindex="-1"></a></span>
<span id="cb118-8"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-8" tabindex="-1"></a>  dat_estima <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cve_mun) <span class="sc">%&gt;%</span> </span>
<span id="cb118-9"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-9" tabindex="-1"></a>    <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">matches</span>(<span class="st">&quot;var&quot;</span>)), mean) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb118-10"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-10" tabindex="-1"></a></span>
<span id="cb118-11"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-11" tabindex="-1"></a>  dat_n <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cve_mun) <span class="sc">%&gt;%</span> <span class="fu">tally</span>()</span>
<span id="cb118-12"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-12" tabindex="-1"></a>  dat_B <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cve_mun) <span class="sc">%&gt;%</span> </span>
<span id="cb118-13"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-13" tabindex="-1"></a>    <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">matches</span>(<span class="st">&quot;var&quot;</span>)), var) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb118-14"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-14" tabindex="-1"></a></span>
<span id="cb118-15"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-15" tabindex="-1"></a>  dat_Ubar <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cve_mun) <span class="sc">%&gt;%</span> </span>
<span id="cb118-16"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-16" tabindex="-1"></a>    <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="fu">matches</span>(<span class="st">&quot;var&quot;</span>)), mean) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb118-17"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-17" tabindex="-1"></a></span>
<span id="cb118-18"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-18" tabindex="-1"></a>  <span class="fu">names</span>(dat_Ubar) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;_var&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">names</span>(dat_Ubar)) </span>
<span id="cb118-19"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-19" tabindex="-1"></a></span>
<span id="cb118-20"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-20" tabindex="-1"></a>  dat_var <span class="ot">&lt;-</span> dat_B <span class="sc">%&gt;%</span> </span>
<span id="cb118-21"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-21" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;Indicador&quot;</span>, <span class="at">value =</span> <span class="st">&quot;B&quot;</span>, <span class="sc">-</span>cve_mun) <span class="sc">%&gt;%</span></span>
<span id="cb118-22"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-22" tabindex="-1"></a>    <span class="fu">inner_join</span>(</span>
<span id="cb118-23"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-23" tabindex="-1"></a>      dat_Ubar <span class="sc">%&gt;%</span> <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;Indicador&quot;</span>, <span class="at">value =</span> <span class="st">&quot;Ubar&quot;</span>, <span class="sc">-</span>cve_mun)</span>
<span id="cb118-24"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-24" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(dat_n)</span>
<span id="cb118-25"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-25" tabindex="-1"></a></span>
<span id="cb118-26"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-26" tabindex="-1"></a>  var_est <span class="ot">&lt;-</span>  dat_var <span class="sc">%&gt;%</span> </span>
<span id="cb118-27"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-27" tabindex="-1"></a>    <span class="fu">transmute</span>(cve_mun, Indicador,</span>
<span id="cb118-28"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-28" tabindex="-1"></a>              <span class="at">var =</span> Ubar <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n)<span class="sc">*</span>B,</span>
<span id="cb118-29"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-29" tabindex="-1"></a>              <span class="at">ee =</span> <span class="fu">sqrt</span>(var)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-30"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-30" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb118-31"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-31" tabindex="-1"></a>      <span class="at">data =</span> .,</span>
<span id="cb118-32"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-32" tabindex="-1"></a>      <span class="at">id_cols =</span> <span class="st">&quot;cve_mun&quot;</span>,</span>
<span id="cb118-33"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-33" tabindex="-1"></a>      <span class="at">names_from =</span> <span class="st">&quot;Indicador&quot;</span>,</span>
<span id="cb118-34"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-34" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&quot;var&quot;</span>, <span class="st">&quot;ee&quot;</span>), <span class="at">values_fill =</span> <span class="dv">0</span></span>
<span id="cb118-35"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-35" tabindex="-1"></a>    ) </span>
<span id="cb118-36"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-36" tabindex="-1"></a></span>
<span id="cb118-37"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-37" tabindex="-1"></a>  dat_var <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb118-38"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-38" tabindex="-1"></a>    <span class="at">data =</span> dat_var,</span>
<span id="cb118-39"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-39" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="st">&quot;cve_mun&quot;</span>,</span>
<span id="cb118-40"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-40" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">&quot;Indicador&quot;</span>,</span>
<span id="cb118-41"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-41" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;Ubar&quot;</span>), <span class="at">values_fill =</span> <span class="dv">0</span></span>
<span id="cb118-42"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-42" tabindex="-1"></a>  ) </span>
<span id="cb118-43"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-43" tabindex="-1"></a></span>
<span id="cb118-44"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-44" tabindex="-1"></a>  resul_ent_ipm[[ii_ent]] <span class="ot">&lt;-</span> dat_n <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(dat_estima) <span class="sc">%&gt;%</span></span>
<span id="cb118-45"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-45" tabindex="-1"></a>    <span class="fu">inner_join</span>(dat_var) <span class="sc">%&gt;%</span></span>
<span id="cb118-46"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-46" tabindex="-1"></a>    <span class="fu">inner_join</span>(var_est)</span>
<span id="cb118-47"><a href="estimacion_municipios_ipm_pobreza_error.html#cb118-47" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="guardar-resultados-y-crear-archivos-excel" class="section level4 unnumbered hasAnchor">
<h4>Guardar Resultados y Crear Archivos Excel<a href="estimacion_municipios_ipm_pobreza_error.html#guardar-resultados-y-crear-archivos-excel" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Combina los resultados de todas las estadoes, los guarda en un archivo RDS y en un archivo Excel. También calcula las estimaciones estatales y las guarda en un archivo Excel separado.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-1" tabindex="-1"></a>temp <span class="ot">&lt;-</span> resul_ent_ipm <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb119-2"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-2" tabindex="-1"></a></span>
<span id="cb119-3"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-3" tabindex="-1"></a>temp <span class="sc">%&lt;&gt;%</span> <span class="fu">inner_join</span>(N_mpio) <span class="sc">%&gt;%</span> </span>
<span id="cb119-4"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-4" tabindex="-1"></a>  <span class="fu">select</span>(ent, cve_mun, N_pers_mpio, est_ipm_I, </span>
<span id="cb119-5"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-5" tabindex="-1"></a>         est_pob_mod, est_pob_ext, est_ipm_II<span class="sc">:</span>est_ipm_IV,</span>
<span id="cb119-6"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-6" tabindex="-1"></a>         <span class="at">ee_ipm_I =</span> ee_est_ipm_I,</span>
<span id="cb119-7"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-7" tabindex="-1"></a>         <span class="at">ee_pob_mod =</span> ee_est_pob_mod,</span>
<span id="cb119-8"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-8" tabindex="-1"></a>         <span class="at">ee_pob_ext =</span> ee_est_pob_ext,</span>
<span id="cb119-9"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-9" tabindex="-1"></a>         <span class="at">ee_ipm_II =</span> ee_est_ipm_II,</span>
<span id="cb119-10"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-10" tabindex="-1"></a>         <span class="at">ee_ipm_III =</span> ee_est_ipm_III,</span>
<span id="cb119-11"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-11" tabindex="-1"></a>         <span class="at">ee_ipm_IV =</span> ee_est_ipm_IV)</span>
<span id="cb119-12"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-12" tabindex="-1"></a></span>
<span id="cb119-13"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-13" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb119-14"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-14" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;../output/Entregas/2020/result_mpios.RDS&quot;</span>)</span>
<span id="cb119-15"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-15" tabindex="-1"></a></span>
<span id="cb119-16"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-16" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(temp,</span>
<span id="cb119-17"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-17" tabindex="-1"></a>                     <span class="fu">paste0</span>(</span>
<span id="cb119-18"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-18" tabindex="-1"></a>                       <span class="st">&quot;../output/Entregas/2020/estimacion_numicipal_&quot;</span>,</span>
<span id="cb119-19"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-19" tabindex="-1"></a>                       <span class="fu">Sys.Date</span>() ,</span>
<span id="cb119-20"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-20" tabindex="-1"></a>                       <span class="st">&quot;.xlsx&quot;</span></span>
<span id="cb119-21"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-21" tabindex="-1"></a>                     ))</span>
<span id="cb119-22"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-22" tabindex="-1"></a></span>
<span id="cb119-23"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-23" tabindex="-1"></a>temp2 <span class="ot">&lt;-</span> temp <span class="sc">%&gt;%</span></span>
<span id="cb119-24"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-24" tabindex="-1"></a>  <span class="fu">select</span>(ent, est_ipm_I<span class="sc">:</span>est_ipm_IV, N_pers_mpio) <span class="sc">%&gt;%</span></span>
<span id="cb119-25"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-25" tabindex="-1"></a>  <span class="fu">group_by</span>(ent) <span class="sc">%&gt;%</span></span>
<span id="cb119-26"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-26" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;est_&quot;</span>),</span>
<span id="cb119-27"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-27" tabindex="-1"></a>                   <span class="sc">~</span> <span class="fu">sum</span>(.x <span class="sc">*</span> N_pers_mpio) <span class="sc">/</span> <span class="fu">sum</span>(N_pers_mpio)))</span>
<span id="cb119-28"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-28" tabindex="-1"></a></span>
<span id="cb119-29"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-29" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(temp2,</span>
<span id="cb119-30"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-30" tabindex="-1"></a>                     <span class="fu">paste0</span>(</span>
<span id="cb119-31"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-31" tabindex="-1"></a>                       <span class="st">&quot;../output/Entregas/2020/estimacion_estado_&quot;</span>,</span>
<span id="cb119-32"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-32" tabindex="-1"></a>                       <span class="fu">Sys.Date</span>() ,</span>
<span id="cb119-33"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-33" tabindex="-1"></a>                       <span class="st">&quot;.xlsx&quot;</span></span>
<span id="cb119-34"><a href="estimacion_municipios_ipm_pobreza_error.html#cb119-34" tabindex="-1"></a>                     <span class="st">&quot;))</span></span></code></pre></div>
</div>
<div id="generación-de-gráficos" class="section level4 unnumbered hasAnchor">
<h4>Generación de Gráficos<a href="estimacion_municipios_ipm_pobreza_error.html#generación-de-gráficos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Genera gráficos para cada tipo de IPM y los guarda en archivos PNG.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-1" tabindex="-1"></a>diseno <span class="ot">&lt;-</span> encuesta_enigh <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-2" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb120-3"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-3" tabindex="-1"></a>    <span class="at">ids =</span> upm,</span>
<span id="cb120-4"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-4" tabindex="-1"></a>    <span class="at">weights =</span> fep,</span>
<span id="cb120-5"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-5" tabindex="-1"></a>    <span class="at">nest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb120-6"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-6" tabindex="-1"></a>    <span class="at">strata =</span> estrato</span>
<span id="cb120-7"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-7" tabindex="-1"></a>  )</span>
<span id="cb120-8"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-8" tabindex="-1"></a></span>
<span id="cb120-9"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-9" tabindex="-1"></a>estimad_dir <span class="ot">&lt;-</span> diseno <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ent, ipm) <span class="sc">%&gt;%</span> </span>
<span id="cb120-10"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-10" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">direct =</span> <span class="fu">survey_mean</span>(<span class="at">vartype =</span> <span class="st">&quot;ci&quot;</span> ))</span>
<span id="cb120-11"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-11" tabindex="-1"></a></span>
<span id="cb120-12"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-12" tabindex="-1"></a>estimad_dir_ipm <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb120-13"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-13" tabindex="-1"></a>  <span class="at">data =</span> estimad_dir,</span>
<span id="cb120-14"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-14" tabindex="-1"></a>  <span class="at">id_cols =</span> <span class="st">&quot;ent&quot;</span>,</span>
<span id="cb120-15"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-15" tabindex="-1"></a>  <span class="at">names_from =</span> <span class="st">&quot;ipm&quot;</span>,</span>
<span id="cb120-16"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-16" tabindex="-1"></a>  <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&quot;direct&quot;</span>, <span class="st">&quot;direct_low&quot;</span>, <span class="st">&quot;direct_upp&quot;</span>)</span>
<span id="cb120-17"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-17" tabindex="-1"></a>) </span>
<span id="cb120-18"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-18" tabindex="-1"></a></span>
<span id="cb120-19"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-19" tabindex="-1"></a>estimad_dir <span class="ot">&lt;-</span> diseno <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ent) <span class="sc">%&gt;%</span> </span>
<span id="cb120-20"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-20" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">direct_mod =</span> <span class="fu">survey_mean</span>(pobre_moderada, <span class="at">vartype =</span> <span class="st">&quot;ci&quot;</span>),</span>
<span id="cb120-21"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-21" tabindex="-1"></a>            <span class="at">direct_ext =</span> <span class="fu">survey_mean</span>(pobre_extrema, <span class="at">vartype =</span> <span class="st">&quot;ci&quot;</span>))</span>
<span id="cb120-22"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-22" tabindex="-1"></a></span>
<span id="cb120-23"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-23" tabindex="-1"></a>estimad_dir <span class="sc">%&lt;&gt;%</span> <span class="fu">inner_join</span>(estimad_dir_ipm)</span>
<span id="cb120-24"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-24" tabindex="-1"></a></span>
<span id="cb120-25"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-25" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;I&quot;</span>, <span class="st">&quot;II&quot;</span>, <span class="st">&quot;III&quot;</span>, <span class="st">&quot;IV&quot;</span>, <span class="st">&quot;mod&quot;</span>, <span class="st">&quot;ext&quot;</span>)</span>
<span id="cb120-26"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-26" tabindex="-1"></a>ii_ipm  <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb120-27"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-27" tabindex="-1"></a><span class="cf">for</span> (ii_ipm <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb120-28"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-28" tabindex="-1"></a>    ii_ipm <span class="ot">&lt;-</span> ind[ii_ipm]</span>
<span id="cb120-29"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-29" tabindex="-1"></a>    paso <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(_|</span><span class="sc">\\</span><span class="st">b)&quot;</span>, ii_ipm, <span class="st">&quot;(_|</span><span class="sc">\\</span><span class="st">b)&quot;</span>)</span>
<span id="cb120-30"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-30" tabindex="-1"></a>    dat_plot <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(estimad_dir, temp2) <span class="sc">%&gt;%</span> </span>
<span id="cb120-31"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-31" tabindex="-1"></a>      <span class="fu">select</span>(ent, <span class="fu">matches</span>(paso))</span>
<span id="cb120-32"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-32" tabindex="-1"></a>  </span>
<span id="cb120-33"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-33" tabindex="-1"></a>    dat_lim  <span class="ot">&lt;-</span> dat_plot <span class="sc">%&gt;%</span> <span class="fu">select</span>(ent, <span class="fu">matches</span>(<span class="st">&quot;upp|low&quot;</span>))</span>
<span id="cb120-34"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-34" tabindex="-1"></a>   </span>
<span id="cb120-35"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-35" tabindex="-1"></a>    <span class="fu">names</span>(dat_lim) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ent&quot;</span>,<span class="st">&quot;Lim_Inf&quot;</span>, <span class="st">&quot;Lim_Sup&quot;</span>)</span>
<span id="cb120-36"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-36" tabindex="-1"></a>   </span>
<span id="cb120-37"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-37" tabindex="-1"></a>    dat_plot <span class="sc">%&lt;&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">matches</span>(<span class="st">&quot;upp|low&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb120-38"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-38" tabindex="-1"></a>      <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;Origen&quot;</span>, <span class="at">value =</span> <span class="st">&quot;Prop&quot;</span>, <span class="sc">-</span>ent) <span class="sc">%&gt;%</span> </span>
<span id="cb120-39"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-39" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Origen =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">&quot;direct&quot;</span>, <span class="at">x =</span> Origen), </span>
<span id="cb120-40"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-40" tabindex="-1"></a>                             <span class="st">&quot;ENIGH&quot;</span>, <span class="st">&quot;Estimación CEPAL&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb120-41"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-41" tabindex="-1"></a>      <span class="fu">inner_join</span>(dat_lim)</span>
<span id="cb120-42"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-42" tabindex="-1"></a>   </span>
<span id="cb120-43"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-43" tabindex="-1"></a>    gg_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dat_plot, <span class="fu">aes</span>(<span class="at">x =</span> ent, <span class="at">y =</span> Prop, <span class="at">color =</span> Origen)) <span class="sc">+</span></span>
<span id="cb120-44"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-44" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb120-45"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-45" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb120-46"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-46" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Estimación&quot;</span>,</span>
<span id="cb120-47"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-47" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb120-48"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-48" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Estimación de la pobreza multidimensional 2020 - Tipo &quot;</span>, ii_ipm )</span>
<span id="cb120-49"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-49" tabindex="-1"></a>      )<span class="sc">+</span> <span class="fu">theme_bw</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb120-50"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-50" tabindex="-1"></a>      <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb120-51"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-51" tabindex="-1"></a>      <span class="fu">theme</span>(legend.position</span>
<span id="cb120-52"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-52" tabindex="-1"></a></span>
<span id="cb120-53"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-53" tabindex="-1"></a> <span class="ot">=</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb120-54"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-54" tabindex="-1"></a>            <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb120-55"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-55" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">100</span>))</span>
<span id="cb120-56"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-56" tabindex="-1"></a>   </span>
<span id="cb120-57"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-57" tabindex="-1"></a>    gg_plot <span class="ot">&lt;-</span>  gg_plot <span class="sc">+</span></span>
<span id="cb120-58"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-58" tabindex="-1"></a>      <span class="fu">geom_errorbar</span>(<span class="at">data =</span> dat_plot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Origen   <span class="sc">==</span> <span class="st">&quot;ENIGH&quot;</span>),</span>
<span id="cb120-59"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-59" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">ymin =</span> Lim_Inf, <span class="at">ymax =</span> Lim_Sup, <span class="at">x =</span> ent),</span>
<span id="cb120-60"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-60" tabindex="-1"></a>                    <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb120-61"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-61" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(</span>
<span id="cb120-62"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-62" tabindex="-1"></a>         <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;ENIGH&quot;</span>, <span class="st">&quot;Estimación CEPAL&quot;</span>),</span>
<span id="cb120-63"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-63" tabindex="-1"></a>         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue3&quot;</span>)</span>
<span id="cb120-64"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-64" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb120-65"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-65" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb120-66"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-66" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb120-67"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-67" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb120-68"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-68" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb120-69"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-69" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb120-70"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-70" tabindex="-1"></a>          <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb120-71"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-71" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb120-72"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-72" tabindex="-1"></a>          <span class="at">vjust =</span> <span class="fl">0.3</span></span>
<span id="cb120-73"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-73" tabindex="-1"></a>        ),</span>
<span id="cb120-74"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-74" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb120-75"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-75" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)</span>
<span id="cb120-76"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-76" tabindex="-1"></a>      )</span>
<span id="cb120-77"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-77" tabindex="-1"></a>   </span>
<span id="cb120-78"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-78" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="at">plot =</span> gg_plot, <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">9</span>,</span>
<span id="cb120-79"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-79" tabindex="-1"></a>           <span class="at">filename =</span> <span class="fu">paste0</span>(<span class="st">&quot;../output/Entregas/2020/plot_uni/ipm_&quot;</span>, ii_ipm, <span class="st">&quot;.png&quot;</span>))</span>
<span id="cb120-80"><a href="estimacion_municipios_ipm_pobreza_error.html#cb120-80" tabindex="-1"></a>}</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estimacion_municipios_ipm_pobreza.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mapas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/2023MEXsae/15_estimacion_municipios_ipm_pobreza_error.qmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020.pdf", "Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020.epub", "Manual de procesamiento del indicador de pobreza multidimensional mediante el uso de estimación de áreas pequeñas para México 2020.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

</body>

</html>
